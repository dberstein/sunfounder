

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="./">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.3 Avertisseur de recul &mdash; Documentation SunFounder davinci-kit-for-raspberry-pi </title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css%3Fv=80d5e7a1.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css%3Fv=e59714d7.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css%3Fv=76b2166b.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/custom.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/index.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/xterm.css" />

  
      <script src="_static/jquery.js%3Fv=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js%3Fv=2cd50e6c"></script>
      <script src="_static/documentation_options.js%3Fv=d1a510d7"></script>
      <script src="_static/doctools.js%3Fv=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js%3Fv=dc90522c"></script>
      <script src="_static/clipboard.min.js%3Fv=a7894cd8"></script>
      <script src="_static/copybutton.js%3Fv=f281be69"></script>
      <script src="_static/translations.js%3Fv=bf059b8c"></script>
      <script src="https://ezblock.cc/readDocFile/custom.js"></script>
      <script src="https://docs.sunfounder.com/projects/davinci-kit/fr/latest/_static/lang.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ace.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ext-language_tools.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/theme-chrome.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-python.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-sh.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/monokai.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/xterm.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/FitAddon.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/readTheDocIndex.js"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/versions.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="3.1.4 Ventilateur intelligent" href="3.1.4_smart_fan.html" />
    <link rel="prev" title="3.1.2 Bienvenue" href="3.1.2_welcome.html" /> 
<script async type="text/javascript" src="../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="davinci-kit-fr" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/3.1.3_reversing_alarm.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">
<nav id="nav-bar">
  <ul class="nav-bar-items" id="nav-bar-items">
    <li class="nav-bar-logo">
      <a href="https://sunfounder.com">
        <img class="logo-img" src="https://ezblock.cc/readDocFile/sunfounder_LOGO_160x@2x.png"/>
      </a>
    </li>
  </ul>
</nav>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SunFounder davinci-kit-for-raspberry-pi
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">About this Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="component_list.html">Liste des composants</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio_extension_board.html">Carte d’extension GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_the_code.html">Download the Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_setup_os/install_setup_os.html">Installer et Configurer le Système d’Exploitation Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_pi5.html">Pour le Pi 5</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="for_other_models.html">Pour Pi 4, 3 et Tous les Autres Modèles de Pi</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="libraries.html">Bibliothèques</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_output.html">1 Sorties</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_input.html">2 Entrée</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="3_extension.html">3 Extension</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="3.1.1_counting_device.html">3.1.1 Dispositif de comptage</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.2_welcome.html">3.1.2 Bienvenue</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="3.1.3_reversing_alarm.html#">3.1.3 Avertisseur de recul</a><ul>
<li class="toctree-l4"><a class="reference internal" href="3.1.3_reversing_alarm.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.3_reversing_alarm.html#composants">Composants</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.3_reversing_alarm.html#schema-de-cablage">Schéma de câblage</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.3_reversing_alarm.html#procedures-experimentales">Procédures expérimentales</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.3_reversing_alarm.html#image-du-phenomene">Image du phénomène</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="3.1.4_smart_fan.html">3.1.4 Ventilateur intelligent</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.5_battery_indicator.html">3.1.5 Indicateur de batterie</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.6_motion_control.html">3.1.6 Contrôle de mouvement</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.7_traffic_light.html">3.1.7 Feu de circulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.8_overheat_monitor.html">3.1.8 Moniteur de surchauffe</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.9_password_lock.html">3.1.9 Serrure à code</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.10_alarm_bell.html">3.1.10 Alarme Sonore</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.11_morse_code_generator.html">3.1.11 Générateur de Code Morse</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.12_game_guess_number.html">3.1.12 JEU – Devine le Nombre</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.13_game_10_second.html">3.1.13 JEU – 10 Secondes</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.14_game_not_not.html">3.1.14 JEU - Not Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="processing/play_with_processing.html">Jouer avec Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodejs/play_with_nodejs.html">Jouer avec Node.js</a></li>
<li class="toctree-l2"><a class="reference internal" href="scratch/play_with_scratch.html">Jouer avec Scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_video/python_video.html">Cours vidéo Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/appendix.html">Appendice</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="thank-learning.html">Remerciements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder davinci-kit-for-raspberry-pi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="for_other_models.html">Pour Pi 4, 3 et Tous les Autres Modèles de Pi</a></li>
          <li class="breadcrumb-item"><a href="3_extension.html">3 Extension</a></li>
      <li class="breadcrumb-item active">3.1.3 Avertisseur de recul</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/3.1.3_reversing_alarm.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Bonjour et bienvenue dans la communauté SunFounder pour les passionnés de Raspberry Pi, Arduino et ESP32 sur Facebook ! Plongez au cœur de Raspberry Pi, Arduino et ESP32 avec d’autres passionnés.</p>
<p><strong>Pourquoi rejoindre ?</strong></p>
<ul class="simple">
<li><p><strong>Support d’experts</strong> : Résolvez vos problèmes après-vente et défis techniques avec l’aide de notre communauté et de notre équipe.</p></li>
<li><p><strong>Apprendre &amp; Partager</strong> : Échangez des astuces et des tutoriels pour perfectionner vos compétences.</p></li>
<li><p><strong>Aperçus exclusifs</strong> : Accédez en avant-première aux annonces de nouveaux produits et aux aperçus exclusifs.</p></li>
<li><p><strong>Réductions spéciales</strong> : Profitez de réductions exclusives sur nos nouveaux produits.</p></li>
<li><p><strong>Promotions festives et concours</strong> : Participez à des concours et des promotions spéciales pendant les fêtes.</p></li>
</ul>
<p>👉 Prêt à explorer et créer avec nous ? Cliquez sur [<a href="https://bit.ly/raphaelkit " target="_blank">Ici</a>] et rejoignez-nous dès aujourd’hui !</p>
</div>
<section id="avertisseur-de-recul">
<h1>3.1.3 Avertisseur de recul<a class="headerlink" href="3.1.3_reversing_alarm.html#avertisseur-de-recul" title="Lien vers cette rubrique"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="3.1.3_reversing_alarm.html#introduction" title="Lien vers cette rubrique"></a></h2>
<p>Dans ce projet, nous utiliserons un écran LCD, un buzzer et des capteurs
ultrasoniques pour créer un système d’aide au stationnement en marche arrière.
Nous pouvons l’installer sur un véhicule télécommandé pour simuler le processus
réel de recul d’une voiture dans un garage.</p>
</section>
<section id="composants">
<h2>Composants<a class="headerlink" href="3.1.3_reversing_alarm.html#composants" title="Lien vers cette rubrique"></a></h2>
<img alt="_images/list_Reversing_Alarm.png" class="align-center" src="_images/list_Reversing_Alarm.png" />
</section>
<section id="schema-de-cablage">
<h2>Schéma de câblage<a class="headerlink" href="3.1.3_reversing_alarm.html#schema-de-cablage" title="Lien vers cette rubrique"></a></h2>
<p>Le capteur ultrasonique détecte la distance entre lui-même et l’obstacle, qui sera
affichée sur l’écran LCD sous forme de code. En même temps, le capteur ultrasonique
fait émettre au buzzer un son d’avertissement de fréquence différente selon la valeur
de la distance.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>T-Board Name</p></td>
<td><p>physical</p></td>
<td><p>wiringPi</p></td>
<td><p>BCM</p></td>
</tr>
<tr class="row-even"><td><p>GPIO23</p></td>
<td><p>Pin 16</p></td>
<td><p>4</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO24</p></td>
<td><p>Pin 18</p></td>
<td><p>5</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-even"><td><p>GPIO17</p></td>
<td><p>Pin 11</p></td>
<td><p>0</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-odd"><td><p>SDA1</p></td>
<td><p>Pin 3</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>SCL1</p></td>
<td><p>Pin 5</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<a class="reference internal image-reference" href="_images/Schematic_three_one3.png"><img alt="_images/Schematic_three_one3.png" class="align-center" src="_images/Schematic_three_one3.png" style="width: 800px;" />
</a>
</section>
<section id="procedures-experimentales">
<h2>Procédures expérimentales<a class="headerlink" href="3.1.3_reversing_alarm.html#procedures-experimentales" title="Lien vers cette rubrique"></a></h2>
<p><strong>Étape 1 :</strong> Construisez le circuit.</p>
<a class="reference internal image-reference" href="_images/image242.png"><img alt="_images/image242.png" class="align-center" src="_images/image242.png" style="width: 800px;" />
</a>
<section id="pour-les-utilisateurs-de-langage-c">
<h3><strong>Pour les utilisateurs de langage C</strong><a class="headerlink" href="3.1.3_reversing_alarm.html#pour-les-utilisateurs-de-langage-c" title="Lien vers cette rubrique"></a></h3>
<p><strong>Étape 2 :</strong> Changez de répertoire.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="mf">3.1.3</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Étape 3 :</strong> Compilez.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="mf">3.1.3</span><span class="n">_ReversingAlarm</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">lwiringPi</span>
</pre></div>
</div>
<p><strong>Étape 4 :</strong> Exécutez.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Lorsque le code s’exécute, le module capteur ultrasonique détecte la distance par
rapport à l’obstacle et affiche ensuite l’information sur la distance sur l’écran
LCD1602 ; en outre, le buzzer émet un signal sonore dont la fréquence varie en
fonction de la distance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Si un message d’erreur apparaît <code class="docutils literal notranslate"><span class="pre">wiringPi.h:</span> <span class="pre">Aucun</span> <span class="pre">fichier</span> <span class="pre">ou</span> <span class="pre">dossier</span> <span class="pre">de</span> <span class="pre">ce</span> <span class="pre">type</span></code>, veuillez vous référer à <a class="reference internal" href="libraries.html#install-wiringpi"><span class="std std-ref">Installer et vérifier WiringPi</span></a>.</p></li>
<li><p>Si vous obtenez l’erreur <code class="docutils literal notranslate"><span class="pre">Unable</span> <span class="pre">to</span> <span class="pre">open</span> <span class="pre">I2C</span> <span class="pre">device:</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory</span></code>, vous devez vous référer à <a class="reference internal" href="appendix/i2c_configuration.html#i2c-config"><span class="std std-ref">I2C Configuration</span></a> pour activer I2C et vérifier si le câblage est correct.</p></li>
<li><p>Si le code et le câblage sont corrects mais que l’écran LCD ne s’affiche toujours pas, vous pouvez tourner le potentiomètre à l’arrière pour augmenter le contraste.</p></li>
</ul>
</div>
<p><strong>Code</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Les codes suivants sont incomplets. Si vous souhaitez consulter les codes complets,
il est conseillé d’utiliser la commande <code class="docutils literal notranslate"><span class="pre">nano</span> <span class="pre">3.1.1_ReversingAlarm.c</span></code>.</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;wiringPi.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/time.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;wiringPi.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;wiringPiI2C.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>

<span class="cp">#define Trig    4</span>
<span class="cp">#define Echo    5</span>
<span class="cp">#define Buzzer  0</span>

<span class="kt">int</span><span class="w"> </span><span class="n">LCDAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x27</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">BLEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="p">;</span>

<span class="c1">// voici la fonction pour l&#39;écran LCD</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">write_word</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">){...}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">send_command</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">comm</span><span class="p">){...}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">send_data</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">){...}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">lcdInit</span><span class="p">(){...}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">clear</span><span class="p">(){...}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">data</span><span class="p">[]){...}</span>

<span class="c1">// voici la fonction pour l&#39;ultrasonique</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">ultraInit</span><span class="p">(</span><span class="kt">void</span><span class="p">){...}</span>

<span class="kt">float</span><span class="w"> </span><span class="nf">disMeasure</span><span class="p">(</span><span class="kt">void</span><span class="p">){...}</span>

<span class="c1">// voici la fonction principale</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">dis</span><span class="p">;</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">wiringPiSetup</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">){</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;setup wiringPi failed !&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">pinMode</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">OUTPUT</span><span class="p">);</span>
<span class="w">    </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wiringPiI2CSetup</span><span class="p">(</span><span class="n">LCDAddr</span><span class="p">);</span>
<span class="w">    </span><span class="n">lcdInit</span><span class="p">();</span>
<span class="w">    </span><span class="n">ultraInit</span><span class="p">();</span>

<span class="w">    </span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ultrasonic Starting&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;By Sunfounder&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
<span class="w">        </span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">disMeasure</span><span class="p">();</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.2f cm </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">dis</span><span class="p">);</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">        </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dis</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">400</span><span class="p">){</span>
<span class="w">            </span><span class="n">clear</span><span class="p">();</span>
<span class="w">            </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Error&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of range&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">clear</span><span class="p">();</span>
<span class="w">            </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Distance is&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">sprintf</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="s">&quot;%.2f cm&quot;</span><span class="p">,</span><span class="n">dis</span><span class="p">);</span>
<span class="w">            </span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&gt;=</span><span class="mi">50</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;</span><span class="mi">50</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">dis</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">                </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span>
<span class="w">                </span><span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="w">                </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
<span class="w">                </span><span class="n">delay</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;=</span><span class="mi">20</span><span class="p">){</span>
<span class="w">                </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">                </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span>
<span class="w">                </span><span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="w">                </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
<span class="w">                </span><span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Explication du code</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">pinMode</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">OUTPUT</span><span class="p">);</span>
<span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wiringPiI2CSetup</span><span class="p">(</span><span class="n">LCDAddr</span><span class="p">);</span>
<span class="n">lcdInit</span><span class="p">();</span>
<span class="n">ultraInit</span><span class="p">();</span>
</pre></div>
</div>
<p>Dans ce programme, nous utilisons de manière synthétique les composants précédemment présentés. Ici, nous utilisons des buzzers, un écran LCD et un capteur ultrasonique. Nous pouvons les initialiser de la même manière que précédemment.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">disMeasure</span><span class="p">();</span>
<span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.2f cm </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">dis</span><span class="p">);</span>
<span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dis</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">400</span><span class="p">){</span>
<span class="w">     </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Error&quot;</span><span class="p">);</span>
<span class="w">     </span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of range&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Distance is&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">sprintf</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="s">&quot;%.2f cm&quot;</span><span class="p">,</span><span class="n">dis</span><span class="p">);</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>Ici, nous obtenons la valeur du capteur ultrasonique et déterminons la distance par calcul.</p>
<p>Si la valeur de la distance est supérieure à la portée détectable, un message d’erreur
est affiché sur l’écran LCD. Et si la distance se situe dans la plage acceptable, les
résultats correspondants seront affichés.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">sprintf</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="s">&quot;%.2f cm&quot;</span><span class="p">,</span><span class="n">dis</span><span class="p">);</span>
</pre></div>
</div>
<p>Comme le mode de sortie de l’écran LCD ne supporte que les caractères, et que la variable
<cite>dis</cite> stocke une valeur de type flottant, nous devons utiliser <cite>sprintf()</cite>. Cette fonction
convertit la valeur flottante en un caractère et la stocke dans la variable chaîne <cite>result[]</cite>.
<cite>%.2f</cite> signifie conserver deux chiffres après la virgule.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&gt;=</span><span class="mi">50</span><span class="p">)</span>
<span class="p">{</span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);}</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;</span><span class="mi">50</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">dis</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">    </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="w">    </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;=</span><span class="mi">20</span><span class="p">){</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">    </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="w">    </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cette condition permet de contrôler le son du buzzer. Selon la distance, elle se divise
en trois cas, chacun produisant des fréquences sonores différentes. Comme la valeur totale
du délai est de 500 ms, tous les cas offrent un intervalle de 500 ms pour le capteur ultrasonique.</p>
</section>
<section id="pour-les-utilisateurs-du-langage-python">
<h3><strong>Pour les utilisateurs du langage Python</strong><a class="headerlink" href="3.1.3_reversing_alarm.html#pour-les-utilisateurs-du-langage-python" title="Lien vers cette rubrique"></a></h3>
<p><strong>Étape 2 :</strong> Changez de répertoire.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Étape 3 :</strong> Exécutez.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">3.1.3</span><span class="n">_ReversingAlarm</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Lorsque le code s’exécute, le module capteur ultrasonique détecte la distance par
rapport à l’obstacle et affiche ensuite l’information sur la distance sur l’écran
LCD1602 ; en outre, le buzzer émet un signal sonore dont la fréquence varie en
fonction de la distance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Si vous obtenez l’erreur <code class="docutils literal notranslate"><span class="pre">FileNotFoundError:</span> <span class="pre">[Errno</span> <span class="pre">2]</span> <span class="pre">No</span> <span class="pre">such</span> <span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory:</span> <span class="pre">'/dev/i2c-1'</span></code>, vous devez vous référer à <a class="reference internal" href="appendix/i2c_configuration.html#i2c-config"><span class="std std-ref">I2C Configuration</span></a> pour activer le protocole I2C.</p></li>
<li><p>Si l’erreur <code class="docutils literal notranslate"><span class="pre">ModuleNotFoundError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">'smbus2'</span></code> apparaît, veuillez exécuter la commande <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">smbus2</span></code>.</p></li>
<li><p>Si l’erreur <code class="docutils literal notranslate"><span class="pre">OSError:</span> <span class="pre">[Errno</span> <span class="pre">121]</span> <span class="pre">Remote</span> <span class="pre">I/O</span></code> se produit, cela signifie que le module est mal câblé ou qu’il est défectueux.</p></li>
<li><p>Si le code et le câblage sont corrects mais que l’écran LCD ne s’affiche toujours pas, vous pouvez tourner le potentiomètre à l’arrière pour augmenter le contraste.</p></li>
</ul>
</div>
<p><strong>Code</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vous pouvez <strong>modifier/réinitialiser/copier/exécuter/arrêter</strong> le code ci-dessous. Mais avant cela, vous devez vous rendre sur le chemin du code source comme <code class="docutils literal notranslate"><span class="pre">davinci-kit-for-raspberry-pi/python</span></code>.</p>
</div>
<run></run><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">LCD1602</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">RPi.GPIO</span> <span class="k">as</span> <span class="nn">GPIO</span>

<span class="n">TRIG</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">ECHO</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">BUZZER</span> <span class="o">=</span> <span class="mi">11</span>

<span class="k">def</span> <span class="nf">lcdsetup</span><span class="p">():</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="mh">0x27</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># init(adresse esclave, éclairage de fond)</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Ultrasonic Starting&#39;</span><span class="p">)</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;By SunFounder&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BOARD</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">TRIG</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">ECHO</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
    <span class="n">lcdsetup</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">distance</span><span class="p">():</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">TRIG</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.000002</span><span class="p">)</span>

    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">TRIG</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">TRIG</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">ECHO</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">ECHO</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">time2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">during</span> <span class="o">=</span> <span class="n">time2</span> <span class="o">-</span> <span class="n">time1</span>
    <span class="k">return</span> <span class="n">during</span> <span class="o">*</span> <span class="mi">340</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">100</span>

<span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">dis</span> <span class="o">=</span> <span class="n">distance</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">dis</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dis</span> <span class="o">&gt;</span> <span class="mi">400</span><span class="p">):</span>
            <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">)</span>
        <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Out of range&#39;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Distance is&#39;</span><span class="p">)</span>
            <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dis</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span><span class="s1">&#39; cm&#39;</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&gt;=</span><span class="mi">50</span><span class="p">):</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;</span><span class="mi">50</span> <span class="ow">and</span> <span class="n">dis</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
                    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;=</span><span class="mi">20</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
                    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">setup</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">loop</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Explication du code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lcdsetup</span><span class="p">():</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="mh">0x27</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># init(adresse esclave, éclairage de fond)</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BOARD</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">TRIG</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">ECHO</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
    <span class="n">lcdsetup</span><span class="p">()</span>
</pre></div>
</div>
<p>Dans ce programme, nous utilisons de manière synthétique les composants précédemment
décrits. Ici, nous employons des buzzers, un écran LCD et un capteur ultrasonique.
Nous pouvons les initialiser de la même manière que précédemment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dis</span> <span class="o">=</span> <span class="n">distance</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">dis</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">BUZZER</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dis</span> <span class="o">&gt;</span> <span class="mi">400</span><span class="p">):</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Out of range&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Distance is&#39;</span><span class="p">)</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">dis</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span><span class="s1">&#39; cm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ici, nous récupérons les valeurs du capteur ultrasonique et calculons la distance.
Si la valeur de la distance dépasse la plage de détection, un message d’erreur
s’affiche sur l’écran LCD. Si la distance est dans la plage de fonctionnement, les
résultats correspondants seront affichés.</p>
<p>LCD1602.write(5, 1, str(round(dis,2)) +” cm”)</p>
<p>Comme la sortie de l’écran LCD ne supporte que les types de caractères, nous devons
utiliser <strong>str()</strong> pour convertir les valeurs numériques en caractères. Nous arrondissons
les valeurs à deux décimales.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&gt;=</span><span class="mi">50</span><span class="p">)</span>
<span class="p">{</span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);}</span>
<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;</span><span class="mi">50</span> <span class="o">&amp;</span> <span class="n">dis</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="o">&lt;=</span><span class="mi">20</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">Buzzer</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Cette condition est utilisée pour contrôler le son du buzzer. Selon les différences
de distance, elle est divisée en trois cas, chacun produisant des fréquences sonores
différentes. Comme la valeur totale du délai est de 500 ms, chaque cas fournit un
intervalle de 500 ms permettant au capteur ultrasonique de fonctionner.</p>
</section>
</section>
<section id="image-du-phenomene">
<h2>Image du phénomène<a class="headerlink" href="3.1.3_reversing_alarm.html#image-du-phenomene" title="Lien vers cette rubrique"></a></h2>
<img alt="_images/image243.jpeg" class="align-center" src="_images/image243.jpeg" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="3.1.2_welcome.html" class="btn btn-neutral float-left" title="3.1.2 Bienvenue" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="3.1.4_smart_fan.html" class="btn btn-neutral float-right" title="3.1.4 Ventilateur intelligent" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2025, SunFounder.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>