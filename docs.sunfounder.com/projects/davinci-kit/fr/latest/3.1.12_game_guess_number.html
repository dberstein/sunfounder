

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="./">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.12 JEU – Devine le Nombre &mdash; Documentation SunFounder davinci-kit-for-raspberry-pi </title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css%3Fv=80d5e7a1.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css%3Fv=e59714d7.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css%3Fv=76b2166b.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/custom.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/index.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/xterm.css" />

  
      <script src="_static/jquery.js%3Fv=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js%3Fv=2cd50e6c"></script>
      <script src="_static/documentation_options.js%3Fv=d1a510d7"></script>
      <script src="_static/doctools.js%3Fv=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js%3Fv=dc90522c"></script>
      <script src="_static/clipboard.min.js%3Fv=a7894cd8"></script>
      <script src="_static/copybutton.js%3Fv=f281be69"></script>
      <script src="_static/translations.js%3Fv=bf059b8c"></script>
      <script src="https://ezblock.cc/readDocFile/custom.js"></script>
      <script src="https://docs.sunfounder.com/projects/davinci-kit/fr/latest/_static/lang.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ace.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ext-language_tools.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/theme-chrome.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-python.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-sh.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/monokai.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/xterm.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/FitAddon.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/readTheDocIndex.js"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/versions.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="3.1.13 JEU – 10 Secondes" href="3.1.13_game_10_second.html" />
    <link rel="prev" title="3.1.11 Générateur de Code Morse" href="3.1.11_morse_code_generator.html" /> 
<script async type="text/javascript" src="../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="davinci-kit-fr" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/3.1.12_game_guess_number.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">
<nav id="nav-bar">
  <ul class="nav-bar-items" id="nav-bar-items">
    <li class="nav-bar-logo">
      <a href="https://sunfounder.com">
        <img class="logo-img" src="https://ezblock.cc/readDocFile/sunfounder_LOGO_160x@2x.png"/>
      </a>
    </li>
  </ul>
</nav>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SunFounder davinci-kit-for-raspberry-pi
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">About this Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="component_list.html">Liste des composants</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio_extension_board.html">Carte d’extension GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_the_code.html">Download the Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_setup_os/install_setup_os.html">Installer et Configurer le Système d’Exploitation Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_pi5.html">Pour le Pi 5</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="for_other_models.html">Pour Pi 4, 3 et Tous les Autres Modèles de Pi</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="libraries.html">Bibliothèques</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_output.html">1 Sorties</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_input.html">2 Entrée</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="3_extension.html">3 Extension</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="3.1.1_counting_device.html">3.1.1 Dispositif de comptage</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.2_welcome.html">3.1.2 Bienvenue</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.3_reversing_alarm.html">3.1.3 Avertisseur de recul</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.4_smart_fan.html">3.1.4 Ventilateur intelligent</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.5_battery_indicator.html">3.1.5 Indicateur de batterie</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.6_motion_control.html">3.1.6 Contrôle de mouvement</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.7_traffic_light.html">3.1.7 Feu de circulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.8_overheat_monitor.html">3.1.8 Moniteur de surchauffe</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.9_password_lock.html">3.1.9 Serrure à code</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.10_alarm_bell.html">3.1.10 Alarme Sonore</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.11_morse_code_generator.html">3.1.11 Générateur de Code Morse</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="3.1.12_game_guess_number.html#">3.1.12 JEU – Devine le Nombre</a><ul>
<li class="toctree-l4"><a class="reference internal" href="3.1.12_game_guess_number.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.12_game_guess_number.html#composants">Composants</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.12_game_guess_number.html#schema-de-cablage">Schéma de câblage</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.12_game_guess_number.html#procedures-experimentales">Procédures expérimentales</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.12_game_guess_number.html#photo-du-phenomene">Photo du phénomène</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="3.1.13_game_10_second.html">3.1.13 JEU – 10 Secondes</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.14_game_not_not.html">3.1.14 JEU - Not Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="processing/play_with_processing.html">Jouer avec Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodejs/play_with_nodejs.html">Jouer avec Node.js</a></li>
<li class="toctree-l2"><a class="reference internal" href="scratch/play_with_scratch.html">Jouer avec Scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_video/python_video.html">Cours vidéo Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/appendix.html">Appendice</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="thank-learning.html">Remerciements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder davinci-kit-for-raspberry-pi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="for_other_models.html">Pour Pi 4, 3 et Tous les Autres Modèles de Pi</a></li>
          <li class="breadcrumb-item"><a href="3_extension.html">3 Extension</a></li>
      <li class="breadcrumb-item active">3.1.12 JEU – Devine le Nombre</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/3.1.12_game_guess_number.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Bonjour, bienvenue dans la communauté SunFounder pour les passionnés de Raspberry Pi, Arduino et ESP32 sur Facebook ! Plongez plus profondément dans le monde de Raspberry Pi, Arduino et ESP32 avec d’autres passionnés.</p>
<p><strong>Pourquoi nous rejoindre ?</strong></p>
<ul class="simple">
<li><p><strong>Support d’experts</strong> : Résolvez les problèmes après-vente et les défis techniques avec l’aide de notre communauté et de notre équipe.</p></li>
<li><p><strong>Apprendre &amp; Partager</strong> : Échangez des astuces et des tutoriels pour améliorer vos compétences.</p></li>
<li><p><strong>Aperçus exclusifs</strong> : Recevez en avant-première les annonces de nouveaux produits et des aperçus exclusifs.</p></li>
<li><p><strong>Réductions spéciales</strong> : Profitez de réductions exclusives sur nos nouveaux produits.</p></li>
<li><p><strong>Promotions festives et cadeaux</strong> : Participez à des concours et à des promotions spéciales pendant les fêtes.</p></li>
</ul>
<p>👉 Prêt à explorer et créer avec nous ? Cliquez sur [<a href="https://bit.ly/raphaelkit " target="_blank">Ici</a>] et rejoignez-nous dès aujourd’hui !</p>
</div>
<section id="jeu-devine-le-nombre">
<h1>3.1.12 JEU – Devine le Nombre<a class="headerlink" href="3.1.12_game_guess_number.html#jeu-devine-le-nombre" title="Lien vers cette rubrique"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="3.1.12_game_guess_number.html#introduction" title="Lien vers cette rubrique"></a></h2>
<p>« Deviner le Nombre » est un jeu amusant où vous et vos amis tour à tour entrez
un nombre (0~99). La plage de valeurs se réduit au fur et à mesure que les
joueurs entrent des nombres, jusqu’à ce que quelqu’un devine correctement le
nombre mystère. Ce joueur est alors considéré comme perdant et reçoit une punition.
Par exemple, si le nombre mystère est 51 (non visible par les joueurs), et que
le joueur ① entre 50, la plage de nombres passe à 50~99 ; si le joueur ② entre 70,
la plage devient 50~70 ; et si le joueur ③ entre 51, ce joueur perd. Ici, nous
utilisons un clavier pour entrer les nombres et un écran LCD pour afficher les résultats.</p>
</section>
<section id="composants">
<h2>Composants<a class="headerlink" href="3.1.12_game_guess_number.html#composants" title="Lien vers cette rubrique"></a></h2>
<img alt="_images/list_GAME_Guess_Number.png" class="align-center" src="_images/list_GAME_Guess_Number.png" />
</section>
<section id="schema-de-cablage">
<h2>Schéma de câblage<a class="headerlink" href="3.1.12_game_guess_number.html#schema-de-cablage" title="Lien vers cette rubrique"></a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>T-Board Name</p></td>
<td><p>physical</p></td>
<td><p>wiringPi</p></td>
<td><p>BCM</p></td>
</tr>
<tr class="row-even"><td><p>GPIO18</p></td>
<td><p>Pin 12</p></td>
<td><p>1</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO23</p></td>
<td><p>Pin 16</p></td>
<td><p>4</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>GPIO24</p></td>
<td><p>Pin 18</p></td>
<td><p>5</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO25</p></td>
<td><p>Pin 22</p></td>
<td><p>6</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>SPIMOSI</p></td>
<td><p>Pin 19</p></td>
<td><p>12</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO22</p></td>
<td><p>Pin 15</p></td>
<td><p>3</p></td>
<td><p>22</p></td>
</tr>
<tr class="row-even"><td><p>GPIO27</p></td>
<td><p>Pin 13</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO17</p></td>
<td><p>Pin 11</p></td>
<td><p>0</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-even"><td><p>SDA1</p></td>
<td><p>Pin 3</p></td>
<td><p>SDA1(8)</p></td>
<td><p>SDA1(2)</p></td>
</tr>
<tr class="row-odd"><td><p>SCL1</p></td>
<td><p>Pin 5</p></td>
<td><p>SCL1(9)</p></td>
<td><p>SDA1(3)</p></td>
</tr>
</tbody>
</table>
<img alt="_images/Schematic_three_one12.png" class="align-center" src="_images/Schematic_three_one12.png" />
</section>
<section id="procedures-experimentales">
<h2>Procédures expérimentales<a class="headerlink" href="3.1.12_game_guess_number.html#procedures-experimentales" title="Lien vers cette rubrique"></a></h2>
<p><strong>Étape 1 :</strong> Construire le circuit.</p>
<a class="reference internal image-reference" href="_images/image273.png"><img alt="_images/image273.png" src="_images/image273.png" style="width: 800px;" />
</a>
<p><strong>Étape 2 :</strong> Configurer I2C (voir l’Annexe. Si vous avez déjà configuré I2C,
passez cette étape.)</p>
<section id="pour-les-utilisateurs-du-langage-c">
<h3><strong>Pour les utilisateurs du langage C</strong><a class="headerlink" href="3.1.12_game_guess_number.html#pour-les-utilisateurs-du-langage-c" title="Lien vers cette rubrique"></a></h3>
<p><strong>Étape 3 :</strong> Changer de répertoire.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="mf">3.1.12</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Étape 4 :</strong> Compiler.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="mf">3.1.12</span><span class="n">_GAME_GuessNumber</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">lwiringPi</span>
</pre></div>
</div>
<p><strong>Étape 5 :</strong> Exécuter.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Après le démarrage du programme, l’écran LCD affiche la page d’accueil :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Welcome!
Press A to go!
</pre></div>
</div>
<p>Appuyez sur “A” pour lancer le jeu, et la page de jeu apparaîtra sur l’écran LCD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Entrez le nombre :
0 ‹point‹ 99
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Si cela ne fonctionne pas après l’exécution ou si un message d’erreur s’affiche : « wiringPi.h: No such file or directory », veuillez vous référer à <a class="reference internal" href="faq.html#c-code-is-not-working"><span class="std std-ref">C code is not working?</span></a>.</p>
</div>
<p>Un nombre aléatoire “<strong>point</strong>” est généré mais non affiché sur l’écran LCD au
début du jeu, et votre objectif est de le deviner. Le nombre que vous avez saisi
apparaît à la fin de la première ligne jusqu’à ce que le calcul final soit effectué.
(Appuyez sur “D” pour lancer la comparaison, et si le nombre saisi est supérieur à
<strong>10</strong>, la comparaison se déclenchera automatiquement.)</p>
<p>La plage de valeurs du “<strong>point</strong>” s’affiche sur la seconde ligne. Vous devez entrer
un nombre dans cette plage. À chaque saisie, la plage se réduit ; si vous trouvez le
nombre chanceux, ou si vous perdez, l’écran affichera « Vous avez trouvé ! ».</p>
<p><strong>Explication du code</strong></p>
<p>Au début du code, on trouve les fonctions de base pour le <strong>clavier</strong> et l”
<strong>I2C LCD1602</strong>. Vous pouvez en apprendre davantage sur ces éléments dans les
sections <strong>1.1.7 I2C LCD1602</strong> et <strong>2.1.5 Keypad</strong>.</p>
<p>Voici les points clés à connaître :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/****************************************/</span>
<span class="c1">//Début du code</span>
<span class="cm">/****************************************/</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
<span class="w">    </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wiringPiI2CSetup</span><span class="p">(</span><span class="n">LCDAddr</span><span class="p">);</span>
<span class="w">    </span><span class="n">lcd_init</span><span class="p">();</span>
<span class="w">    </span><span class="n">lcd_clear</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">pinMode</span><span class="p">(</span><span class="n">rowPins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span>
<span class="w">        </span><span class="n">pinMode</span><span class="p">(</span><span class="n">colPins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">INPUT</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">lcd_clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Welcome!&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Press A to go!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cette fonction initialise l”<strong>I2C LCD1602</strong> et le <strong>clavier</strong> tout en affichant
« Bienvenue! » et « Appuyez sur A! ».</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">init_new_value</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
<span class="w">    </span><span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="w">    </span><span class="n">pointValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">100</span><span class="p">;</span>
<span class="w">    </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span><span class="p">;</span>
<span class="w">    </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;point is %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">pointValue</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>La fonction génère un nombre aléatoire “<strong>point</strong>” et réinitialise les limites du jeu.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="nf">detect_point</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">pointValue</span><span class="p">){</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">upper</span><span class="p">){</span>
<span class="w">            </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">pointValue</span><span class="p">){</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">lower</span><span class="p">){</span>
<span class="w">            </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pointValue</span><span class="p">){</span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>La fonction detect_point() compare le nombre saisi avec le « point » généré.
Si les nombres sont différents, <strong>count</strong> est utilisé pour ajuster les valeurs
de <strong>upper</strong> et <strong>lower</strong>, et renvoie “0”. S’ils sont identiques, elle renvoie “1”.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">lcd_show_input</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">result</span><span class="p">){</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="o">=</span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="n">lcd_clear</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">){</span>
<span class="w">        </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;You&#39;ve got it!&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
<span class="w">        </span><span class="n">init_new_value</span><span class="p">();</span>
<span class="w">        </span><span class="n">lcd_show_input</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;Enter number:&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Int2Str</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">count</span><span class="p">);</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">str</span><span class="p">);</span>
<span class="w">    </span><span class="n">Int2Str</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">lower</span><span class="p">);</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">str</span><span class="p">);</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;&lt;Point&lt;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Int2Str</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">upper</span><span class="p">);</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">str</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cette fonction affiche la page de jeu. La fonction <strong>Int2Str(str,count)</strong>
convertit les variables <strong>count</strong>, <strong>lower</strong>, et <strong>upper</strong> d”<strong>entier</strong> en
<strong>chaîne de caractères</strong> pour l’affichage correct sur l”<strong>LCD</strong>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(){</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">pressed_keys</span><span class="p">[</span><span class="n">BUTTON_NUM</span><span class="p">];</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">last_key_pressed</span><span class="p">[</span><span class="n">BUTTON_NUM</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">wiringPiSetup</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">){</span><span class="w"> </span><span class="c1">//when initialize wiring failed,print messageto screen</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;setup wiringPi failed !&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">init</span><span class="p">();</span>
<span class="w">    </span><span class="n">init_new_value</span><span class="p">();</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
<span class="w">        </span><span class="n">keyRead</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">);</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="n">comp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyCompare</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">,</span><span class="w"> </span><span class="n">last_key_pressed</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">comp</span><span class="p">){</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span>
<span class="w">                </span><span class="kt">bool</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">){</span>
<span class="w">                    </span><span class="n">init_new_value</span><span class="p">();</span>
<span class="w">                    </span><span class="n">lcd_show_input</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;D&#39;</span><span class="p">){</span>
<span class="w">                    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detect_point</span><span class="p">();</span>
<span class="w">                    </span><span class="n">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="sc">&#39;0&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">&#39;9&#39;</span><span class="p">){</span>
<span class="w">                    </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w">                    </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">48</span><span class="p">);</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">){</span>
<span class="w">                        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detect_point</span><span class="p">();</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="n">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">keyCopy</span><span class="p">(</span><span class="n">last_key_pressed</span><span class="p">,</span><span class="w"> </span><span class="n">pressed_keys</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>La fonction Main() contient l’ensemble du processus du programme, tel que décrit ci-dessous :</p>
<ol class="arabic">
<li><p>Initialiser l”<strong>I2C LCD1602</strong> et le <strong>clavier</strong>.</p></li>
<li><p>Utiliser <strong>init_new_value()</strong> pour créer un nombre aléatoire entre <strong>0 et 99</strong>.</p></li>
<li><p>Vérifier si un bouton a été pressé et lire sa valeur.</p></li>
<li><p>Si le bouton '<strong>A</strong>' est pressé, un nombre aléatoire entre <strong>0 et 99</strong> est
généré et le jeu commence.</p></li>
<li><dl class="simple">
<dt>Si le bouton '<strong>D</strong>' est détecté comme pressé, le programme passe à l’étape de</dt><dd><p>comparaison et affiche le résultat sur l’écran LCD. Cette étape permet également</p>
</dd>
</dl>
<p>de juger le résultat en appuyant seulement sur un chiffre et ensuite sur le bouton '<strong>D</strong>'.</p>
</li>
<li><p>Si un des boutons <strong>0-9</strong> est pressé, la valeur de <strong>count</strong> sera modifiée ; si
<strong>count</strong> est supérieur à <strong>10</strong>, la comparaison démarre.</p></li>
<li><p>Les changements de jeu et leurs valeurs sont affichés sur l”<strong>LCD1602</strong>.</p></li>
</ol>
</section>
<section id="pour-les-utilisateurs-python">
<h3><strong>Pour les utilisateurs Python</strong><a class="headerlink" href="3.1.12_game_guess_number.html#pour-les-utilisateurs-python" title="Lien vers cette rubrique"></a></h3>
<p><strong>Étape 3</strong> : Accéder au répertoire.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Étape 4</strong> : Exécuter le programme.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">3.1.12</span><span class="n">_GAME_GuessNumber</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Après le démarrage du programme, la page initiale s’affiche sur l’écran LCD :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Welcome!
Press A to go!
</pre></div>
</div>
<p>Appuyez sur 'A', et le jeu commencera. La page du jeu apparaîtra sur l’écran LCD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Enter number:
0 ‹point‹ 99
</pre></div>
</div>
<p>Un nombre aléatoire '<strong>point</strong>' est généré mais n’est pas affiché sur l’écran
LCD au début du jeu, et votre objectif est de le deviner. Le nombre que vous avez
saisi s’affiche à la fin de la première ligne jusqu’à ce que le calcul final soit
terminé. (Appuyez sur 'D' pour démarrer la comparaison, et si le nombre saisi
est supérieur à <strong>10</strong>, la comparaison automatique commencera.)</p>
<p>L’intervalle de nombres pour 'point' est affiché sur la seconde ligne. Vous devez
taper un nombre dans cet intervalle. À chaque tentative, l’intervalle se rétrécit ;
si vous trouvez le nombre chanceux par hasard, l’écran affichera « Vous avez trouvé! »</p>
<p><strong>Code</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vous pouvez <strong>Modifier/Réinitialiser/Copier/Exécuter/Arrêter</strong> le code ci-dessous.
Mais avant cela, vous devez accéder au chemin source du code comme <code class="docutils literal notranslate"><span class="pre">davinci-kit-for-raspberry-pi/python</span></code>.</p>
</div>
<run></run><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">RPi.GPIO</span> <span class="k">as</span> <span class="nn">GPIO</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">LCD1602</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1">##################### LIBRAIRIE KEYPAD ADAPTÉE D&#39;ARDUINO ############</span>
<span class="c1">#class Key: Définition de quelques propriétés de Key</span>
<span class="k">class</span> <span class="nc">Keypad</span><span class="p">():</span>

   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rowsPins</span><span class="p">,</span> <span class="n">colsPins</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rowsPins</span> <span class="o">=</span> <span class="n">rowsPins</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">colsPins</span> <span class="o">=</span> <span class="n">colsPins</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="n">keys</span>
      <span class="n">GPIO</span><span class="o">.</span><span class="n">setwarnings</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
      <span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BCM</span><span class="p">)</span>
      <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rowsPins</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
      <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colsPins</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">pull_up_down</span><span class="o">=</span><span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_DOWN</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">pressed_keys</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rowsPins</span><span class="p">):</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colsPins</span><span class="p">):</span>
               <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colsPins</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                  <span class="n">pressed_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">pressed_keys</span>

<span class="c1">################ DÉBUT DU CODE D&#39;EXEMPLE ################</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pointValue</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">upper</span><span class="o">=</span><span class="mi">99</span>
<span class="n">lower</span><span class="o">=</span><span class="mi">0</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
   <span class="k">global</span> <span class="n">keypad</span><span class="p">,</span> <span class="n">last_key_pressed</span><span class="p">,</span><span class="n">keys</span>
   <span class="n">rowsPins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">]</span>
   <span class="n">colsPins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">17</span><span class="p">]</span>
   <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;5&quot;</span><span class="p">,</span><span class="s2">&quot;6&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
            <span class="s2">&quot;7&quot;</span><span class="p">,</span><span class="s2">&quot;8&quot;</span><span class="p">,</span><span class="s2">&quot;9&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
            <span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;#&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">]</span>
   <span class="n">keypad</span> <span class="o">=</span> <span class="n">Keypad</span><span class="p">(</span><span class="n">rowsPins</span><span class="p">,</span> <span class="n">colsPins</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
   <span class="n">last_key_pressed</span> <span class="o">=</span> <span class="p">[]</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="mh">0x27</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1"># init(adresse esclave, lumière de fond)</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Welcome!&#39;</span><span class="p">)</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Press A to Start!&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">init_new_value</span><span class="p">():</span>
   <span class="k">global</span> <span class="n">pointValue</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">count</span><span class="p">,</span><span class="n">lower</span>
   <span class="n">pointValue</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span>
   <span class="n">upper</span> <span class="o">=</span> <span class="mi">99</span>
   <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;point is </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">pointValue</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">detect_point</span><span class="p">():</span>
   <span class="k">global</span> <span class="n">count</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">lower</span>
   <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">pointValue</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="n">count</span>
   <span class="k">elif</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">pointValue</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">lower</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="n">count</span>
   <span class="k">elif</span> <span class="n">count</span> <span class="o">==</span> <span class="n">pointValue</span><span class="p">:</span>
      <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">return</span> <span class="mi">1</span>
   <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
   <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;You have got it!&#39;</span><span class="p">)</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
      <span class="n">init_new_value</span><span class="p">()</span>
      <span class="n">lcd_show_input</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Enter number:&#39;</span><span class="p">)</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">lower</span><span class="p">))</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; &lt; Point &lt; &#39;</span><span class="p">)</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">upper</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
   <span class="k">global</span> <span class="n">keypad</span><span class="p">,</span> <span class="n">last_key_pressed</span><span class="p">,</span><span class="n">count</span>
   <span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">pressed_keys</span> <span class="o">=</span> <span class="n">keypad</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">last_key_pressed</span> <span class="o">!=</span> <span class="n">pressed_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pressed_keys</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]:</span>
               <span class="n">init_new_value</span><span class="p">()</span>
               <span class="n">lcd_show_input</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pressed_keys</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]:</span>
               <span class="n">result</span> <span class="o">=</span> <span class="n">detect_point</span><span class="p">()</span>
               <span class="n">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
               <span class="k">if</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;#&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">]):</span>
                  <span class="k">continue</span>
               <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">10</span>
               <span class="n">count</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
               <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                  <span class="n">result</span> <span class="o">=</span> <span class="n">detect_point</span><span class="p">()</span>
               <span class="n">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">)</span>
      <span class="n">last_key_pressed</span> <span class="o">=</span> <span class="n">pressed_keys</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Fonction pour nettoyer tout après la fin du script</span>
<span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>
   <span class="c1"># Libérer les ressources</span>
   <span class="n">GPIO</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
   <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>     <span class="c1"># Le programme commence ici</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">setup</span><span class="p">()</span>
      <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">loop</span><span class="p">()</span>
   <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>   <span class="c1"># Quand &#39;Ctrl+C&#39; est pressé, la fonction destroy() sera exécutée.</span>
      <span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Explication du code</strong></p>
<p>Au début du code, vous trouverez les fonctions liées au <strong>clavier</strong> et à l”
<strong>I2C LCD1602</strong>. Vous pouvez en savoir plus à leur sujet dans les sections
<strong>1.1.7 I2C LCD1602</strong> et <strong>2.1.5 Clavier</strong>.</p>
<p>Voici ce qu’il faut savoir :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">init_new_value</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">pointValue</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">count</span><span class="p">,</span><span class="n">lower</span>
    <span class="n">pointValue</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="mi">99</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;point is </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">pointValue</span><span class="p">))</span>
</pre></div>
</div>
<p>Cette fonction génère un nombre aléatoire appelé “<strong>point</strong>” et réinitialise
l’intervalle de recherche.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">detect_point</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">count</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">lower</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">pointValue</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="n">count</span>
    <span class="k">elif</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">pointValue</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">lower</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="n">count</span>
    <span class="k">elif</span> <span class="n">count</span> <span class="o">==</span> <span class="n">pointValue</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
<p>La fonction detect_point() compare le nombre saisi (<strong>count</strong>) avec le nombre
aléatoire “<strong>point</strong>”. Si les nombres ne sont pas identiques, <strong>count</strong> attribue
de nouvelles valeurs à <strong>upper</strong> et <strong>lower</strong>, et retourne “<strong>0</strong>”. Si les nombres
sont identiques, la fonction retourne “<strong>1</strong>”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;You have got it!&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">init_new_value</span><span class="p">()</span>
        <span class="n">lcd_show_input</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Enter number:&#39;</span><span class="p">)</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">lower</span><span class="p">))</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39; &lt; Point &lt; &#39;</span><span class="p">)</span>
    <span class="n">LCD1602</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">upper</span><span class="p">))</span>
</pre></div>
</div>
<p>Cette fonction affiche l’interface du jeu.</p>
<p>str(count) : Étant donné que <strong>write()</strong> ne prend en charge que les chaînes de
caractères (<strong>string</strong>), il est nécessaire de convertir le <strong>nombre</strong> en <strong>chaîne</strong>
à l’aide de <strong>str()</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">keypad</span><span class="p">,</span> <span class="n">last_key_pressed</span><span class="p">,</span><span class="n">count</span>
    <span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pressed_keys</span> <span class="o">=</span> <span class="n">keypad</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">last_key_pressed</span> <span class="o">!=</span> <span class="n">pressed_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pressed_keys</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]:</span>
                <span class="n">init_new_value</span><span class="p">()</span>
                <span class="n">lcd_show_input</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pressed_keys</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">detect_point</span><span class="p">()</span>
                <span class="n">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;#&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">]):</span>
                    <span class="k">continue</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">*</span> <span class="mi">10</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">detect_point</span><span class="p">()</span>
                <span class="n">lcd_show_input</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">)</span>
        <span class="n">last_key_pressed</span> <span class="o">=</span> <span class="n">pressed_keys</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>Main() contient l’ensemble du processus du programme, comme décrit ci-dessous :</p>
<ol class="arabic simple">
<li><p>Initialiser <strong>I2C LCD1602</strong> et <strong>Keypad</strong>.</p></li>
<li><p>Vérifier si un bouton est pressé et lire sa valeur.</p></li>
<li><p>Si le bouton “<strong>A</strong>” est pressé, un nombre aléatoire entre <strong>0 et 99</strong> est
généré, et le jeu commence.</p></li>
<li><p>Si le bouton “<strong>D</strong>” est pressé, le programme effectue la comparaison et
détermine le résultat.</p></li>
<li><dl class="simple">
<dt>Si un des boutons <strong>0-9</strong> est pressé, la valeur de <strong>count</strong> est modifiée. Si</dt><dd><p><strong>count</strong> est supérieur à <strong>10</strong>, la comparaison commence.</p>
</dd>
</dl>
</li>
<li><p>Les changements dans le jeu et les valeurs sont affichés sur l’écran <strong>LCD1602</strong>.</p></li>
</ol>
</section>
</section>
<section id="photo-du-phenomene">
<h2>Photo du phénomène<a class="headerlink" href="3.1.12_game_guess_number.html#photo-du-phenomene" title="Lien vers cette rubrique"></a></h2>
<img alt="_images/image274.jpeg" class="align-center" src="_images/image274.jpeg" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="3.1.11_morse_code_generator.html" class="btn btn-neutral float-left" title="3.1.11 Générateur de Code Morse" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="3.1.13_game_10_second.html" class="btn btn-neutral float-right" title="3.1.13 JEU – 10 Secondes" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2025, SunFounder.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>