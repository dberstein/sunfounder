

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.7 Feu de Signalisation &mdash; Documentation SunFounder davinci-kit-for-raspberry-pi </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css%3Fv=80d5e7a1.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css%3Fv=e59714d7.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css%3Fv=76b2166b.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/custom.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/index.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/xterm.css" />

  
      <script src="../_static/jquery.js%3Fv=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js%3Fv=2cd50e6c"></script>
      <script src="../_static/documentation_options.js%3Fv=d1a510d7"></script>
      <script src="../_static/doctools.js%3Fv=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js%3Fv=dc90522c"></script>
      <script src="../_static/clipboard.min.js%3Fv=a7894cd8"></script>
      <script src="../_static/copybutton.js%3Fv=f281be69"></script>
      <script src="../_static/translations.js%3Fv=bf059b8c"></script>
      <script src="https://ezblock.cc/readDocFile/custom.js"></script>
      <script src="https://docs.sunfounder.com/projects/davinci-kit/fr/latest/_static/lang.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ace.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ext-language_tools.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/theme-chrome.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-python.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-sh.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/monokai.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/xterm.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/FitAddon.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/readTheDocIndex.js"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/versions.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="3.1.8 Moniteur de surchauffe" href="pi5_3.1.8_overheat_monitor_python.html" />
    <link rel="prev" title="3.1.6 Contrôle de Mouvement" href="pi5_3.1.6_motion_control_python.html" /> 
<script async type="text/javascript" src="../../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="davinci-kit-fr" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/python_pi5/pi5_3.1.7_traffic_light_python.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">
<nav id="nav-bar">
  <ul class="nav-bar-items" id="nav-bar-items">
    <li class="nav-bar-logo">
      <a href="https://sunfounder.com">
        <img class="logo-img" src="https://ezblock.cc/readDocFile/sunfounder_LOGO_160x@2x.png"/>
      </a>
    </li>
  </ul>
</nav>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SunFounder davinci-kit-for-raspberry-pi
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">About this Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_list.html">Liste des composants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpio_extension_board.html">Carte d’extension GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download_the_code.html">Download the Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_setup_os/install_setup_os.html">Installer et Configurer le Système d’Exploitation Raspberry Pi</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../for_pi5.html">Pour le Pi 5</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="play_with_python_pi5.html">Jouez avec Python</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="check_the_gpiozero_python.html">Vérifiez l’installation de <code class="docutils literal notranslate"><span class="pre">GPIO</span> <span class="pre">Zero</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pi5_output_python.html">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="pi5_input_python.html">Input</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pi5_extension_python.html">Extension</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.1_counting_device_python.html">3.1.1 Dispositif de Comptage</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.2_welcome_python.html">3.1.2 Bienvenue</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.3_reversing_alarm_python.html">3.1.3 Alarme de Recul</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.4_smart_fan_python.html">3.1.4 Ventilateur intelligent</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.5_battery_indicator_python.html">3.1.5 Indicateur de Batterie</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.6_motion_control_python.html">3.1.6 Contrôle de Mouvement</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="pi5_3.1.7_traffic_light_python.html#">3.1.7 Feu de Signalisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.8_overheat_monitor_python.html">3.1.8 Moniteur de surchauffe</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.9_password_lock_python.html">3.1.9 Serrure à Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.10_alarm_bell_python.html">3.1.10 Alarme Manuelle</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.11_morse_code_generator_python.html">3.1.11 Générateur de Code Morse</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.12_game_guess_number_python.html">3.1.12 JEU – Devine le Nombre</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.13_game_10_second_python.html">3.1.13 JEU – 10 Secondes</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.14_game_not_not_python.html">3.1.14 JEU – Not Not</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_pi5/play_with_c.html">Play with C</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scratch_pi5/play_with_scratch.html">Jouer avec Scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../for_other_models.html">Pour Pi 4, 3 et Tous les Autres Modèles de Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_video/python_video.html">Cours vidéo Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix.html">Appendice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thank-learning.html">Remerciements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SunFounder davinci-kit-for-raspberry-pi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../for_pi5.html">Pour le Pi 5</a></li>
          <li class="breadcrumb-item"><a href="play_with_python_pi5.html">Jouez avec Python</a></li>
          <li class="breadcrumb-item"><a href="pi5_extension_python.html">Extension</a></li>
      <li class="breadcrumb-item active">3.1.7 Feu de Signalisation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/python_pi5/pi5_3.1.7_traffic_light_python.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Bonjour, bienvenue dans la communauté SunFounder Raspberry Pi &amp; Arduino &amp; ESP32 Enthusiasts sur Facebook ! Plongez au cœur de Raspberry Pi, Arduino et ESP32 avec d’autres passionnés.</p>
<p><strong>Pourquoi nous rejoindre ?</strong></p>
<ul class="simple">
<li><p><strong>Support d’experts</strong> : Résolvez vos problèmes après-vente et relevez les défis techniques avec l’aide de notre communauté et de notre équipe.</p></li>
<li><p><strong>Apprenez et partagez</strong> : Échangez des astuces et des tutoriels pour améliorer vos compétences.</p></li>
<li><p><strong>Aperçus exclusifs</strong> : Accédez en avant-première aux annonces de nouveaux produits et aux aperçus exclusifs.</p></li>
<li><p><strong>Réductions spéciales</strong> : Bénéficiez de réductions exclusives sur nos produits les plus récents.</p></li>
<li><p><strong>Promotions festives et cadeaux</strong> : Participez à des concours et à des promotions spéciales lors des fêtes.</p></li>
</ul>
<p>👉 Prêt à explorer et créer avec nous ? Cliquez sur [<a href="https://bit.ly/raphaelkit " target="_blank">Ici</a>] et rejoignez-nous dès aujourd’hui !</p>
</div>
<section id="feu-de-signalisation">
<span id="py-pi5-traffic"></span><h1>3.1.7 Feu de Signalisation<a class="headerlink" href="pi5_3.1.7_traffic_light_python.html#feu-de-signalisation" title="Lien vers cette rubrique"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="pi5_3.1.7_traffic_light_python.html#introduction" title="Lien vers cette rubrique"></a></h2>
<p>Dans ce projet, nous allons utiliser des LED de trois couleurs pour simuler le
changement des feux de signalisation. Un affichage à 4 chiffres de type 7 segments
sera également utilisé pour afficher le compte à rebours de chaque état de signalisation.</p>
</section>
<section id="composants-necessaires">
<h2>Composants Nécessaires<a class="headerlink" href="pi5_3.1.7_traffic_light_python.html#composants-necessaires" title="Lien vers cette rubrique"></a></h2>
<p>Pour ce projet, nous aurons besoin des composants suivants.</p>
<a class="reference internal image-reference" href="../_images/4.1.12_traffic_light_list.png"><img alt="../_images/4.1.12_traffic_light_list.png" class="align-center" src="../_images/4.1.12_traffic_light_list.png" style="width: 800px;" />
</a>
</section>
<section id="schema-de-montage">
<h2>Schéma de Montage<a class="headerlink" href="pi5_3.1.7_traffic_light_python.html#schema-de-montage" title="Lien vers cette rubrique"></a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>T-Board Name</p></td>
<td><p>physical</p></td>
<td><p>wiringPi</p></td>
<td><p>BCM</p></td>
</tr>
<tr class="row-even"><td><p>GPIO17</p></td>
<td><p>Pin 11</p></td>
<td><p>0</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO27</p></td>
<td><p>Pin 13</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-even"><td><p>GPIO22</p></td>
<td><p>Pin 15</p></td>
<td><p>3</p></td>
<td><p>22</p></td>
</tr>
<tr class="row-odd"><td><p>SPIMOSI</p></td>
<td><p>Pin 19</p></td>
<td><p>12</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>GPIO18</p></td>
<td><p>Pin 12</p></td>
<td><p>1</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO23</p></td>
<td><p>Pin 16</p></td>
<td><p>4</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>GPIO24</p></td>
<td><p>Pin 18</p></td>
<td><p>5</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO25</p></td>
<td><p>Pin 22</p></td>
<td><p>6</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>SPICE0</p></td>
<td><p>Pin 24</p></td>
<td><p>10</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>SPICE1</p></td>
<td><p>Pin 26</p></td>
<td><p>11</p></td>
<td><p>7</p></td>
</tr>
</tbody>
</table>
<img alt="../_images/4.1.12_traffic_light_schematic.png" class="align-center" src="../_images/4.1.12_traffic_light_schematic.png" />
</section>
<section id="procedures-experimentales">
<h2>Procédures Expérimentales<a class="headerlink" href="pi5_3.1.7_traffic_light_python.html#procedures-experimentales" title="Lien vers cette rubrique"></a></h2>
<p><strong>Étape 1 :</strong> Montez le circuit.</p>
<img alt="../_images/4.1.12_traffic_light_circuit.png" src="../_images/4.1.12_traffic_light_circuit.png" />
<p><strong>Étape 2 :</strong> Changez de répertoire.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">pi5</span>
</pre></div>
</div>
<p><strong>Étape 3 :</strong> Exécutez le programme.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">3.1.7</span><span class="n">_TrafficLight</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Une fois le code exécuté, les LED simuleront le changement des feux de signalisation.
D’abord, la LED rouge s’allume pendant 60 secondes, puis la LED verte pendant 30 secondes ;
ensuite, la LED jaune s’allume pendant 5 secondes. Après cela, la LED rouge se rallume
pendant 60 secondes. Cette série d’actions se répétera indéfiniment. En même temps,
l’affichage à 4 chiffres de type 7 segments affichera le compte à rebours en continu.</p>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="pi5_3.1.7_traffic_light_python.html#code" title="Lien vers cette rubrique"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vous pouvez <strong>Modifier/Réinitialiser/Copier/Exécuter/Arrêter</strong> le code ci-dessous. Mais avant cela, vous devez vous rendre dans le chemin source, comme <code class="docutils literal notranslate"><span class="pre">davinci-kit-for-raspberry-pi/python-pi5</span></code>. Après avoir modifié le code, vous pouvez l’exécuter directement pour voir l’effet.</p>
</div>
<run></run><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">from</span> <span class="nn">gpiozero</span> <span class="kn">import</span> <span class="n">OutputDevice</span><span class="p">,</span> <span class="n">LED</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="c1"># Configuration des broches GPIO pour le registre à décalage 74HC595</span>
<span class="n">SDI</span> <span class="o">=</span> <span class="n">OutputDevice</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>   <span class="c1"># Entrée de données série</span>
<span class="n">RCLK</span> <span class="o">=</span> <span class="n">OutputDevice</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>  <span class="c1"># Horloge de registre</span>
<span class="n">SRCLK</span> <span class="o">=</span> <span class="n">OutputDevice</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="c1"># Horloge de registre de décalage</span>

<span class="c1"># Configuration des broches GPIO pour la sélection des chiffres sur l&#39;affichage 7 segments</span>
<span class="n">placePin</span> <span class="o">=</span> <span class="p">[</span><span class="n">OutputDevice</span><span class="p">(</span><span class="n">pin</span><span class="p">)</span> <span class="k">for</span> <span class="n">pin</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">17</span><span class="p">)]</span>

<span class="c1"># Codes des segments pour les chiffres 0 à 9 sur l&#39;afficheur 7 segments</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>

<span class="c1"># Configuration des broches GPIO pour les LED du feu de signalisation</span>
<span class="n">ledPinR</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c1"># LED rouge</span>
<span class="n">ledPinG</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># LED verte</span>
<span class="n">ledPinY</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># LED jaune</span>

<span class="c1"># Paramètres de durée pour chaque phase du feu de signalisation</span>
<span class="n">greenLight</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">yellowLight</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">redLight</span> <span class="o">=</span> <span class="mi">60</span>

<span class="c1"># Noms des couleurs des feux</span>
<span class="n">lightColor</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">)</span>

<span class="c1"># Variables d&#39;état initialisées</span>
<span class="n">colorState</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">timer1</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Initialize the traffic light system and start the timer. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">clearDisplay</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Clear the 7-segment display. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">SDI</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">hc595_shift</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Shift data to the 74HC595 shift register for digit display. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">SDI</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mh">0x80</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">pickDigit</span><span class="p">(</span><span class="n">digit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Select a specific digit to display on the 7-segment display. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">pin</span> <span class="ow">in</span> <span class="n">placePin</span><span class="p">:</span>
        <span class="n">pin</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">placePin</span><span class="p">[</span><span class="n">digit</span><span class="p">]</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">timer</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Handle the timing for traffic light changes. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">counter</span><span class="p">,</span> <span class="n">colorState</span><span class="p">,</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">counter</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="p">[</span><span class="n">greenLight</span><span class="p">,</span> <span class="n">yellowLight</span><span class="p">,</span> <span class="n">redLight</span><span class="p">][</span><span class="n">colorState</span><span class="p">]</span>
        <span class="n">colorState</span> <span class="o">=</span> <span class="p">(</span><span class="n">colorState</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;counter : </span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">    color: </span><span class="si">{</span><span class="n">lightColor</span><span class="p">[</span><span class="n">colorState</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">lightup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Update the traffic light LED based on the current state. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="n">ledPinR</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinG</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinY</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="p">[</span><span class="n">ledPinR</span><span class="p">,</span> <span class="n">ledPinG</span><span class="p">,</span> <span class="n">ledPinY</span><span class="p">][</span><span class="n">colorState</span><span class="p">]</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">display</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Display the current counter value on the 7-segment display. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">counter</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">digit</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">//</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">digit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
        <span class="n">pickDigit</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">digit</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Main loop to continuously update display and lights. &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">display</span><span class="p">()</span>
        <span class="n">lightup</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Clean up resources when the script is terminated. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="n">ledPinR</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinG</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinY</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">setup</span><span class="p">()</span>
    <span class="n">loop</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="explication-du-code">
<h2>Explication du Code<a class="headerlink" href="pi5_3.1.7_traffic_light_python.html#explication-du-code" title="Lien vers cette rubrique"></a></h2>
<ol class="arabic">
<li><p>Importe les classes <code class="docutils literal notranslate"><span class="pre">OutputDevice</span></code> et <code class="docutils literal notranslate"><span class="pre">LED</span></code> de la bibliothèque gpiozero, permettant de contrôler des dispositifs de sortie généraux et spécifiquement des LED. Importe le module de threading de Python, utilisé pour créer et gérer des threads pour l’exécution simultanée.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">from</span> <span class="nn">gpiozero</span> <span class="kn">import</span> <span class="n">OutputDevice</span><span class="p">,</span> <span class="n">LED</span>
<span class="kn">import</span> <span class="nn">threading</span>
</pre></div>
</div>
</li>
<li><p>Initialise les broches GPIO connectées aux entrées du registre à décalage : Entrée de données série (SDI), Horloge de registre (RCLK), et Horloge de décalage (SRCLK).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuration des broches GPIO pour le registre à décalage 74HC595</span>
<span class="n">SDI</span> <span class="o">=</span> <span class="n">OutputDevice</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>   <span class="c1"># Entrée de données série</span>
<span class="n">RCLK</span> <span class="o">=</span> <span class="n">OutputDevice</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>  <span class="c1"># Horloge de registre</span>
<span class="n">SRCLK</span> <span class="o">=</span> <span class="n">OutputDevice</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="c1"># Horloge de registre de décalage</span>
</pre></div>
</div>
</li>
<li><p>Initialise les broches pour chaque chiffre de l’affichage 7 segments et définit les codes binaires correspondant aux chiffres de 0 à 9.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuration des broches GPIO pour la sélection des chiffres sur l&#39;affichage 7 segments</span>
<span class="n">placePin</span> <span class="o">=</span> <span class="p">[</span><span class="n">OutputDevice</span><span class="p">(</span><span class="n">pin</span><span class="p">)</span> <span class="k">for</span> <span class="n">pin</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">17</span><span class="p">)]</span>

<span class="c1"># Codes des segments pour les chiffres 0-9 sur l&#39;affichage 7 segments</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Initialise les broches GPIO pour les LED rouge, verte et jaune utilisées dans la simulation des feux de signalisation. Définit la durée (en secondes) pour chaque état de couleur dans le système de feux de signalisation et nomme chaque couleur de feu pour référence.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuration des broches GPIO pour les LED du feu de signalisation</span>
<span class="n">ledPinR</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c1"># LED rouge</span>
<span class="n">ledPinG</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># LED verte</span>
<span class="n">ledPinY</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># LED jaune</span>

<span class="c1"># Paramètres de durée pour chaque phase du feu de signalisation</span>
<span class="n">greenLight</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">yellowLight</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">redLight</span> <span class="o">=</span> <span class="mi">60</span>

<span class="c1"># Noms des couleurs des feux</span>
<span class="n">lightColor</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Yellow&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Initialise les variables pour suivre l’état actuel des couleurs, un compteur pour la temporisation et un espace réservé pour un objet de minuteur.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialisation des variables d&#39;état</span>
<span class="n">colorState</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">timer1</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</li>
<li><p>Initialise le système de feux de signalisation et démarre le thread du minuteur.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Initialize the traffic light system and start the timer. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Fonctions pour contrôler l’affichage 7 segments. <code class="docutils literal notranslate"><span class="pre">clearDisplay</span></code> éteint tous les segments, <code class="docutils literal notranslate"><span class="pre">hc595_shift</span></code> transfère les données dans le registre à décalage et <code class="docutils literal notranslate"><span class="pre">pickDigit</span></code> active un chiffre spécifique sur l’affichage.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clearDisplay</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Clear the 7-segment display. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">SDI</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">hc595_shift</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Shift data to the 74HC595 shift register for digit display. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">SDI</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mh">0x80</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
        <span class="n">SRCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="n">RCLK</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">pickDigit</span><span class="p">(</span><span class="n">digit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Select a specific digit to display on the 7-segment display. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">pin</span> <span class="ow">in</span> <span class="n">placePin</span><span class="p">:</span>
        <span class="n">pin</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">placePin</span><span class="p">[</span><span class="n">digit</span><span class="p">]</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Gère le minutage pour les changements de feux de signalisation et met à jour le compteur et l’état des couleurs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">timer</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Handle the timing for traffic light changes. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">counter</span><span class="p">,</span> <span class="n">colorState</span><span class="p">,</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">counter</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="p">[</span><span class="n">greenLight</span><span class="p">,</span> <span class="n">yellowLight</span><span class="p">,</span> <span class="n">redLight</span><span class="p">][</span><span class="n">colorState</span><span class="p">]</span>
        <span class="n">colorState</span> <span class="o">=</span> <span class="p">(</span><span class="n">colorState</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;counter : </span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">    color: </span><span class="si">{</span><span class="n">lightColor</span><span class="p">[</span><span class="n">colorState</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Met à jour l’état des LED du feu de signalisation en fonction de l’état de couleur actuel.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lightup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Update the traffic light LED based on the current state. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="n">ledPinR</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinG</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinY</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="p">[</span><span class="n">ledPinR</span><span class="p">,</span> <span class="n">ledPinG</span><span class="p">,</span> <span class="n">ledPinY</span><span class="p">][</span><span class="n">colorState</span><span class="p">]</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Calcule le chiffre à afficher sur chaque segment de l’affichage 7 segments et le met à jour en conséquence.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Display the current counter value on the 7-segment display. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">counter</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">digit</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">//</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">digit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
        <span class="n">pickDigit</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">digit</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Boucle principale qui met à jour en continu l’affichage et les LED du feu de signalisation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Main loop to continuously update display and lights. &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">display</span><span class="p">()</span>
        <span class="n">lightup</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Libère les ressources lorsque le script est terminé, comme éteindre les LED et arrêter le thread du minuteur.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Clean up resources when the script is terminated. &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="n">ledPinR</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinG</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="n">ledPinY</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="pi5_3.1.6_motion_control_python.html" class="btn btn-neutral float-left" title="3.1.6 Contrôle de Mouvement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="pi5_3.1.8_overheat_monitor_python.html" class="btn btn-neutral float-right" title="3.1.8 Moniteur de surchauffe" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2025, SunFounder.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>