

<!DOCTYPE html>
<html class="writer-html5" lang="it" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.2.7 Modulo RFID MFRC522 &mdash; SunFounder davinci-kit-for-raspberry-pi  documentazione</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css%3Fv=80d5e7a1.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css%3Fv=e59714d7.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css%3Fv=76b2166b.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/custom.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/index.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/xterm.css" />

  
      <script src="../_static/jquery.js%3Fv=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js%3Fv=2cd50e6c"></script>
      <script src="../_static/documentation_options.js%3Fv=3fd72285"></script>
      <script src="../_static/doctools.js%3Fv=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js%3Fv=dc90522c"></script>
      <script src="../_static/clipboard.min.js%3Fv=a7894cd8"></script>
      <script src="../_static/copybutton.js%3Fv=f281be69"></script>
      <script src="../_static/translations.js%3Fv=0173e136"></script>
      <script src="https://ezblock.cc/readDocFile/custom.js"></script>
      <script src="https://docs.sunfounder.com/projects/davinci-kit/it/latest/_static/lang.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ace.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ext-language_tools.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/theme-chrome.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-python.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-sh.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/monokai.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/xterm.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/FitAddon.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/readTheDocIndex.js"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/versions.js"></script>
    <link rel="index" title="Indice" href="../genindex.html" />
    <link rel="search" title="Cerca" href="../search.html" />
    <link rel="next" title="Estensioni" href="pi5_extension_python.html" />
    <link rel="prev" title="2.2.6 Modulo MPU6050" href="pi5_2.2.6_mpu6050_module_python.html" /> 
<script async type="text/javascript" src="../../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="davinci-kit-it" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/python_pi5/pi5_2.2.7_mfrc522_rfid_module_python.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">
<nav id="nav-bar">
  <ul class="nav-bar-items" id="nav-bar-items">
    <li class="nav-bar-logo">
      <a href="https://sunfounder.com">
        <img class="logo-img" src="https://ezblock.cc/readDocFile/sunfounder_LOGO_160x@2x.png"/>
      </a>
    </li>
  </ul>
</nav>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SunFounder davinci-kit-for-raspberry-pi
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Cerca documenti" aria-label="Cerca documenti" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu di navigazione">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">About this Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_list.html">Elenco dei Componenti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpio_extension_board.html">Scheda di Estensione GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download_the_code.html">Scarica il Codice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_setup_os/install_setup_os.html">Installazione e configurazione di Raspberry Pi OS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../for_pi5.html">Per Pi 5</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="play_with_python_pi5.html">Divertiti con Python</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="check_the_gpiozero_python.html">Verifica di <code class="docutils literal notranslate"><span class="pre">GPIO</span> <span class="pre">Zero</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pi5_output_python.html">Output</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pi5_input_python.html">Input</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pi5_input_python.html#controller">2.1 Controller</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="pi5_input_python.html#sensori">2.2 Sensori</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pi5_extension_python.html">Estensioni</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_pi5/play_with_c.html">Gioca con C</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scratch_pi5/play_with_scratch.html">Giocare con Scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../for_other_models.html">Per Pi 4, 3 e tutti gli altri modelli Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_video/python_video.html">Corso Video Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix.html">Appendice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thank-learning.html">Grazie</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu navigazione dispositivi mobili" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SunFounder davinci-kit-for-raspberry-pi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Naviga tra le pagine">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../for_pi5.html">Per Pi 5</a></li>
          <li class="breadcrumb-item"><a href="play_with_python_pi5.html">Divertiti con Python</a></li>
          <li class="breadcrumb-item"><a href="pi5_input_python.html">Input</a></li>
      <li class="breadcrumb-item active">2.2.7 Modulo RFID MFRC522</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/python_pi5/pi5_2.2.7_mfrc522_rfid_module_python.rst.txt" rel="nofollow"> Visualizza sorgente pagina</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Ciao, benvenuto nella SunFounder Raspberry Pi &amp; Arduino &amp; ESP32 Enthusiasts Community su Facebook! Approfondisci l‚Äôesplorazione del Raspberry Pi, Arduino ed ESP32 con altri appassionati.</p>
<p><strong>Perch√© unirti a noi?</strong></p>
<ul class="simple">
<li><p><strong>Supporto esperto</strong>: Risolvi i problemi post-vendita e le sfide tecniche con l‚Äôaiuto della nostra comunit√† e del nostro team.</p></li>
<li><p><strong>Impara e condividi</strong>: Scambia consigli e tutorial per migliorare le tue competenze.</p></li>
<li><p><strong>Anteprime esclusive</strong>: Accedi in anteprima agli annunci di nuovi prodotti e alle anticipazioni esclusive.</p></li>
<li><p><strong>Sconti speciali</strong>: Approfitta di sconti esclusivi sui nostri prodotti pi√π recenti.</p></li>
<li><p><strong>Promozioni e omaggi festivi</strong>: Partecipa a omaggi e promozioni speciali durante le festivit√†.</p></li>
</ul>
<p>üëâ Sei pronto a esplorare e creare con noi? Clicca su [<a href="https://bit.ly/raphaelkit " target="_blank">Qui</a>] e unisciti oggi stesso!</p>
</div>
<section id="modulo-rfid-mfrc522">
<span id="rfid-py"></span><h1>2.2.7 Modulo RFID MFRC522<a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#modulo-rfid-mfrc522" title="Link to this heading">ÔÉÅ</a></h1>
<section id="introduzione">
<h2>Introduzione<a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#introduzione" title="Link to this heading">ÔÉÅ</a></h2>
<p>La Radio Frequency Identification (RFID) si riferisce a tecnologie che utilizzano
la comunicazione wireless tra un oggetto (o tag) e un dispositivo di interrogazione
(o lettore) per tracciare e identificare automaticamente tali oggetti.</p>
<p>Alcune delle applicazioni pi√π comuni di questa tecnologia includono catene di fornitura
al dettaglio, catene di fornitura militari, metodi di pagamento automatizzati, tracciamento
e gestione dei bagagli, monitoraggio dei documenti e gestione farmaceutica, solo per citarne alcuni.</p>
<p>In questo progetto, utilizzeremo RFID per leggere e scrivere informazioni.</p>
</section>
<section id="componenti-necessari">
<h2>Componenti necessari<a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#componenti-necessari" title="Link to this heading">ÔÉÅ</a></h2>
<p>In questo progetto avremo bisogno dei seguenti componenti.</p>
<img alt="../_images/list_2.2.7.png" src="../_images/list_2.2.7.png" />
</section>
<section id="schema-elettrico">
<h2>Schema elettrico<a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#schema-elettrico" title="Link to this heading">ÔÉÅ</a></h2>
<img alt="../_images/image331.png" src="../_images/image331.png" />
</section>
<section id="procedura-sperimentale">
<h2>Procedura sperimentale<a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#procedura-sperimentale" title="Link to this heading">ÔÉÅ</a></h2>
<p><strong>Passo 1:</strong> Costruisci il circuito.</p>
<img alt="../_images/image232.png" src="../_images/image232.png" />
<p><strong>Passo 2:</strong> Attivare SPI prima di iniziare l‚Äôesperimento, vedere <a class="reference internal" href="../appendix/spi_configuration.html#spi-configuration"><span class="std std-ref">Configurazione SPI</span></a> per i dettagli.</p>
<p><strong>Passo 3:</strong> Andare nella cartella del codice.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">pi5</span>
</pre></div>
</div>
<p><strong>Passo 4:</strong> Eseguire <code class="docutils literal notranslate"><span class="pre">2.2.10_write.py</span></code>.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">2.2.10</span><span class="n">_write</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><strong>Passo 5:</strong> Dopo aver eseguito il programma, inserire il testo che si desidera scrivere (fino a 16 caratteri), come ¬´welcome¬ª, e premere Invio per confermare. Dopo di ci√≤, il programma mostrer√† ¬´Data has been written to the card¬ª. Infine, premere <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code> per interrompere l‚Äôesecuzione del codice.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Please place your RFID card on the reader...
Press Ctrl-C to stop.
RFID card detected!
Card UID: 9BF6210B
Please enter data to write to the card (up to 16 characters): welcome
Block 8 authentication successful
4 backdata &amp;0x0F == 0x0A 10
Data written
Data has been written to the card
Reading data from block 8:
Sector 8 [119, 101, 108, 99, 111, 109, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</pre></div>
</div>
<p><strong>Passo 6:</strong> Ora eseguire <code class="docutils literal notranslate"><span class="pre">2.2.10_read.py</span></code> per leggere le informazioni sul tag o la scheda che √® stata scritta.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">2.2.10</span><span class="n">_read</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><strong>Passo 7:</strong> Dopo l‚Äôesecuzione, verranno visualizzate le seguenti informazioni.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Please place your RFID card on the reader...
Press Ctrl-C to stop.
RFID card detected!
Card UID: 9BF6210B
Block 8 authentication successful
Sector 8 [119, 101, 108, 99, 111, 109, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0]
MFRC522_Read return type: &lt;class &#39;int&#39;&gt;, Data: [119, 101, 108, 99, 111, 109, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Sector 8 [119, 101, 108, 99, 111, 109, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Read data: welcome
</pre></div>
</div>
</section>
<section id="analisi-del-codice-di-2-2-10-write-py">
<h2>Analisi del codice di <code class="docutils literal notranslate"><span class="pre">2.2.10_write.py</span></code><a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#analisi-del-codice-di-2-2-10-write-py" title="Link to this heading">ÔÉÅ</a></h2>
<p>Questo script Python scrive dati forniti dall‚Äôutente su una scheda RFID usando il lettore RFID MFRC522. Lo script verifica continuamente la presenza di una scheda, richiede all‚Äôutente di inserire i dati da scrivere e conferma le operazioni di scrittura e lettura riuscite.</p>
<ol class="arabic">
<li><p>Importazione dei moduli</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MFRC522</span></code>: Importa le funzioni e le classi necessarie per le operazioni del lettore RFID.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signal</span></code> e <code class="docutils literal notranslate"><span class="pre">time</span></code>: <code class="docutils literal notranslate"><span class="pre">signal</span></code> √® usato per gestire la terminazione tramite SIGINT (Ctrl+C), e <code class="docutils literal notranslate"><span class="pre">time</span></code> per aggiungere ritardi nel ciclo principale.</p></li>
</ul>
</li>
<li><p>Variabile globale</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">continue_reading</span></code>: Controlla il ciclo principale, permettendo di terminare il programma impostando il valore a <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">continue_reading</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</li>
<li><p>Gestione del segnale:</p>
<ul class="simple">
<li><p>Funzione <code class="docutils literal notranslate"><span class="pre">end_read</span></code>: Questa funzione viene attivata quando viene rilevato <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code> (SIGINT). Imposta <code class="docutils literal notranslate"><span class="pre">continue_reading</span></code> su <code class="docutils literal notranslate"><span class="pre">False</span></code>, permettendo di terminare il programma.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signal.signal(signal.SIGINT,</span> <span class="pre">end_read)</span></code>: Associa il segnale SIGINT (Ctrl+C) a <code class="docutils literal notranslate"><span class="pre">end_read</span></code>, cos√¨, se interrotto, il programma mostrer√† un messaggio e si chiuder√† in modo ordinato.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">end_read</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Configurazione del lettore RFID:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rfid_reader</span></code>: Un‚Äôistanza della classe <code class="docutils literal notranslate"><span class="pre">MFRC522</span></code>, utilizzata per controllare le operazioni del lettore RFID.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_key</span></code>: Un elenco di 6 byte, di solito <code class="docutils literal notranslate"><span class="pre">0xFF</span></code> per ogni byte. Questa √® la chiave di autenticazione predefinita per la maggior parte delle schede RFID.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creare un&#39;istanza della classe MFRC522</span>
<span class="n">rfid_reader</span> <span class="o">=</span> <span class="n">MFRC522</span><span class="o">.</span><span class="n">MFRC522</span><span class="p">()</span>

<span class="c1"># Definire la chiave predefinita (6 byte, di default tutti 0xFF)</span>
<span class="n">default_key</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Istruzioni per l‚Äôutente</p>
<p>Lo script stampa istruzioni nella console, informando l‚Äôutente di posizionare la scheda RFID sul lettore e utilizzare <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code> per uscire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please place your RFID card on the reader...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl-C to stop.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Ciclo principale: Rilevamento, Scrittura e Lettura dei Dati</p>
<ul class="simple">
<li><p><strong>Rilevamento della Scheda</strong>: Lo script chiama continuamente <code class="docutils literal notranslate"><span class="pre">MFRC522_Request</span></code> per rilevare le schede RFID. Se una scheda viene rilevata (<code class="docutils literal notranslate"><span class="pre">status</span> <span class="pre">==</span> <span class="pre">rfid_reader.MI_OK</span></code>), procede al passaggio successivo.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">TagType</span><span class="p">)</span> <span class="o">=</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_Request</span><span class="p">(</span><span class="n">rfid_reader</span><span class="o">.</span><span class="n">PICC_REQIDL</span><span class="p">)</span>

<span class="c1"># Se una scheda viene rilevata</span>
<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MI_OK</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RFID card detected!&quot;</span><span class="p">)</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Attendere un po&#39; prima di riprovare</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Recupero dell‚ÄôUID della Scheda</strong>: Chiama <code class="docutils literal notranslate"><span class="pre">MFRC522_SelectTagSN</span></code> per recuperare l‚Äôidentificatore unico (UID) della scheda. Se riuscito, l‚ÄôUID viene convertito in una stringa esadecimale e stampato. L‚ÄôUID √® necessario per l‚Äôautenticazione.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span> <span class="o">=</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_SelectTagSN</span><span class="p">()</span>

<span class="c1"># Se l&#39;UID √® stato recuperato, continuare</span>
<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MI_OK</span><span class="p">:</span>
    <span class="c1"># Stampare l&#39;UID</span>
    <span class="n">uid_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%02X</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">uid</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Card UID: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">uid_str</span><span class="p">)</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to get card UID&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Preparazione dei Dati</strong>:</p>
<ul>
<li><p><strong>Richiesta di Inserimento</strong>: All‚Äôutente viene richiesto di inserire i dati da scrivere sulla scheda (fino a 16 caratteri).</p></li>
<li><p><strong>Troncamento dei Dati</strong>: I dati vengono troncati a 16 caratteri se l‚Äôutente inserisce di pi√π.</p></li>
<li><p><strong>Conversione da Stringa a Byte</strong>: L‚Äôinput dell‚Äôutente viene convertito in una lista di byte, riempita fino a 16 byte, come richiesto dal formato di archiviazione della scheda RFID.</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">write_data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter data to write to the card (up to 16 characters): &quot;</span><span class="p">)</span>
<span class="c1"># Assicurarsi che i dati non superino i 16 caratteri</span>
<span class="n">write_data</span> <span class="o">=</span> <span class="n">write_data</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
<span class="c1"># Convertire la stringa in una lista di byte, riempire fino a 16 byte</span>
<span class="n">data_to_write</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">]</span><span class="o">*</span><span class="mi">16</span>
<span class="n">string_bytes</span> <span class="o">=</span> <span class="n">write_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">string_bytes</span><span class="p">)):</span>
    <span class="n">data_to_write</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">string_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Specificare il Numero di Blocco</strong>: Lo script specifica il blocco 8 per scrivere i dati. Nota: i numeri di blocco devono evitare i blocchi di intestazione del settore, generalmente l‚Äôultimo blocco in ogni settore, poich√© sono usati per informazioni di controllo.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">block_num</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Per esempio, scegliere il blocco 8</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Autenticazione della Scheda</strong>: <code class="docutils literal notranslate"><span class="pre">MFRC522_Auth</span></code> autentica il blocco specificato usando la chiave predefinita e l‚ÄôUID. Se l‚Äôautenticazione √® riuscita, lo script procede con la scrittura dei dati.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">status</span> <span class="o">=</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_Auth</span><span class="p">(</span><span class="n">rfid_reader</span><span class="o">.</span><span class="n">PICC_AUTHENT1A</span><span class="p">,</span> <span class="n">block_num</span><span class="p">,</span> <span class="n">default_key</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MI_OK</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Autenticazione del blocco </span><span class="si">%d</span><span class="s2"> riuscita&quot;</span> <span class="o">%</span> <span class="n">block_num</span><span class="p">)</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Autenticazione fallita&quot;</span><span class="p">)</span>
    <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_StopCrypto1</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Scrittura dei Dati sulla Scheda</strong>: <code class="docutils literal notranslate"><span class="pre">MFRC522_Write</span></code> scrive i dati preparati sul blocco specificato della scheda RFID. Dopo la scrittura, un messaggio conferma che i dati sono stati scritti correttamente sulla scheda.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_Write</span><span class="p">(</span><span class="n">block_num</span><span class="p">,</span> <span class="n">data_to_write</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data has been written to the card&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<p><strong>Punti Chiave</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Terminazione Ordinata</strong>: Lo script cattura SIGINT (Ctrl+C) per terminare in modo sicuro e stampare un messaggio, consentendo il completamento di qualsiasi operazione in corso prima di uscire.</p></li>
<li><p><strong>Interazione con l‚ÄôUtente</strong>: Richiede all‚Äôutente di inserire dati, consentendo la personalizzazione dei dati ogni volta che la scheda viene scritta.</p></li>
<li><p><strong>Autenticazione</strong>: Garantisce che l‚Äôaccesso al blocco specificato sia gestito in modo sicuro.</p></li>
<li><p><strong>Formattazione dei Dati</strong>: Converte i dati della stringa in un formato di lista di byte compatibile.</p></li>
</ul>
</div></blockquote>
</section>
<section id="spiegazione-del-codice-per-2-2-10-read-py">
<h2>Spiegazione del Codice per <code class="docutils literal notranslate"><span class="pre">2.2.10_read.py</span></code><a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#spiegazione-del-codice-per-2-2-10-read-py" title="Link to this heading">ÔÉÅ</a></h2>
<p>Questo script Python utilizza un <strong>lettore RFID (MFRC522)</strong> per leggere dati dalle schede RFID. Lo script √® strutturato per controllare continuamente la presenza di schede, recuperare i dati e gestire in modo ordinato le richieste di uscita tramite gestione dei segnali.</p>
<ol class="arabic">
<li><p>Importazione dei Moduli:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MFRC522</span></code>: Questo modulo fornisce metodi per interagire con il lettore RFID MFRC522.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signal</span></code> e <code class="docutils literal notranslate"><span class="pre">time</span></code>: Utilizzati per gestire la terminazione dello script (es. <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code>) e controllare i tempi di alcune operazioni.</p></li>
</ul>
</li>
<li><p>Variabili Globali:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">continue_reading</span></code>: Una variabile booleana che controlla il ciclo principale di lettura, permettendo allo script di interrompersi in modo ordinato quando si preme <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">continue_reading</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</li>
<li><p>Gestione dei Segnali:</p>
<ul class="simple">
<li><p>Funzione <code class="docutils literal notranslate"><span class="pre">end_read</span></code>: Questa funzione viene attivata quando viene rilevato <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code> (SIGINT). Imposta <code class="docutils literal notranslate"><span class="pre">continue_reading</span></code> su <code class="docutils literal notranslate"><span class="pre">False</span></code>, permettendo allo script di uscire in modo ordinato.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signal.signal(signal.SIGINT,</span> <span class="pre">end_read)</span></code>: Collega il segnale SIGINT (Ctrl+C) a <code class="docutils literal notranslate"><span class="pre">end_read</span></code>, in modo che, se interrotto, lo script mostri un messaggio e si chiuda ordinatamente.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">end_read</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Configurazione del Lettore RFID:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rfid_reader</span></code>: Un‚Äôistanza della classe <code class="docutils literal notranslate"><span class="pre">MFRC522</span></code>, utilizzata per le operazioni del lettore RFID.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_key</span></code>: Una lista di 6 byte, tipicamente <code class="docutils literal notranslate"><span class="pre">0xFF</span></code> per ogni byte. Questa √® la chiave di autenticazione predefinita per la maggior parte delle schede RFID.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">block_num</span></code>: Specifica il numero di blocco da leggere dalla scheda RFID, qui impostato al blocco <code class="docutils literal notranslate"><span class="pre">8</span></code>. Il numero di blocco deve corrispondere a quello utilizzato durante la scrittura dei dati.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creare un&#39;istanza della classe MFRC522</span>
<span class="n">rfid_reader</span> <span class="o">=</span> <span class="n">MFRC522</span><span class="o">.</span><span class="n">MFRC522</span><span class="p">()</span>

<span class="c1"># Definire la chiave predefinita (6 byte, di default tutti 0xFF)</span>
<span class="n">default_key</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">]</span>

<span class="c1"># Definire il numero di blocco da leggere (deve corrispondere al blocco utilizzato durante la scrittura)</span>
<span class="n">block_num</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Per esempio, blocco 8</span>
</pre></div>
</div>
</li>
<li><p>Istruzioni per l‚ÄôUtente</p>
<p>Lo script stampa istruzioni nella console, informando l‚Äôutente di posizionare la scheda RFID sul lettore e di utilizzare <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code> per uscire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please place your RFID card on the reader...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl-C to stop.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Ciclo Principale: Rilevamento della Scheda RFID e Lettura dei Dati.</p>
<ul>
<li><p><strong>Scansione delle Schede</strong>: Il ciclo principale chiama continuamente <code class="docutils literal notranslate"><span class="pre">MFRC522_Request</span></code> per rilevare le schede RFID. Se una scheda viene rilevata, procede ai passaggi successivi.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">TagType</span><span class="p">)</span> <span class="o">=</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_Request</span><span class="p">(</span><span class="n">rfid_reader</span><span class="o">.</span><span class="n">PICC_REQIDL</span><span class="p">)</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MI_OK</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RFID card detected!&quot;</span><span class="p">)</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Se non viene rilevata nessuna scheda, attendere un breve periodo prima di riprovare</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Recupero dell‚ÄôUID della Scheda</strong>: Usa <code class="docutils literal notranslate"><span class="pre">MFRC522_SelectTagSN</span></code> per ottenere l‚Äôidentificatore unico (UID) della scheda. Se riuscito, converte l‚ÄôUID in una stringa esadecimale e lo stampa. Questo UID √® necessario per autenticare la scheda.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span> <span class="o">=</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_SelectTagSN</span><span class="p">()</span>

<span class="c1"># Se l&#39;UID √® stato recuperato con successo, procedere</span>
<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MI_OK</span><span class="p">:</span>
    <span class="c1"># Convertire la lista UID in una stringa esadecimale</span>
    <span class="n">uid_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%02X</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">uid</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Card UID: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">uid_str</span><span class="p">)</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to get card UID&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Autenticazione della Scheda</strong>: <code class="docutils literal notranslate"><span class="pre">MFRC522_Auth</span></code> autentica l‚Äôaccesso al blocco specificato usando la chiave predefinita e l‚ÄôUID della scheda. Se l‚Äôautenticazione riesce, lo script passa alla lettura dei dati dal blocco.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">status</span> <span class="o">=</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_Auth</span><span class="p">(</span><span class="n">rfid_reader</span><span class="o">.</span><span class="n">PICC_AUTHENT1A</span><span class="p">,</span> <span class="n">block_num</span><span class="p">,</span> <span class="n">default_key</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>

<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MI_OK</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Autenticazione del blocco </span><span class="si">%d</span><span class="s2"> riuscita&quot;</span> <span class="o">%</span> <span class="n">block_num</span><span class="p">)</span>
    <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Autenticazione fallita, codice di stato: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">status</span><span class="p">)</span>
    <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_StopCrypto1</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><strong>Lettura dei Dati</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MFRC522_Read</span></code> legge i dati dal blocco specificato.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>: Questa variabile contiene i dati grezzi del blocco se l‚Äôoperazione di lettura ha successo.</p></li>
<li><p>Lo script converte ogni byte in <code class="docutils literal notranslate"><span class="pre">data</span></code> in caratteri e rimuove eventuali byte nulli di padding (<code class="docutils literal notranslate"><span class="pre">\x00</span></code>). I dati elaborati vengono quindi stampati.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">read_status</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_Read</span><span class="p">(</span><span class="n">block_num</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MFRC522_Read return type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">read_status</span><span class="p">)</span><span class="si">}</span><span class="s2">, Data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">read_status</span> <span class="o">==</span> <span class="n">rfid_reader</span><span class="o">.</span><span class="n">MI_OK</span> <span class="ow">and</span> <span class="n">data</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Settore </span><span class="si">{</span><span class="n">block_num</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Convertire i dati in byte a stringa e rimuovere eventuali byte nulli di padding</span>
    <span class="n">read_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dati letti: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">read_data</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lettura dei dati fallita, codice di stato: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">read_status</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">MFRC522_StopCrypto1</span></code> viene chiamato per fermare la crittografia e reimpostare la comunicazione della scheda.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fermare la crittografia sulla scheda</span>
<span class="n">rfid_reader</span><span class="o">.</span><span class="n">MFRC522_StopCrypto1</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><strong>Attesa tra le Letture</strong>: Se non viene rilevata alcuna scheda, il ciclo si interrompe per 0,5 secondi prima di riprovare.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">else</span><span class="p">:</span>
    <span class="c1"># Se non viene rilevata nessuna scheda, attendere un breve periodo prima di riprovare</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
<p><strong>Punti Chiave</strong></p>
<ul class="simple">
<li><p><strong>Uscita Ordinata</strong>: Lo script cattura il segnale <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code> per una terminazione ordinata, consentendo al lettore RFID di completare qualsiasi operazione in corso.</p></li>
<li><p><strong>Gestione del Blocco e dell‚ÄôUID</strong>: Usa il blocco e l‚ÄôUID come componenti chiave nella lettura dei dati da una scheda RFID, con una corretta gestione di autenticazione e errori di lettura.</p></li>
<li><p><strong>Design Modulare</strong>: L‚Äôuso di funzioni dedicate dal modulo <code class="docutils literal notranslate"><span class="pre">MFRC522</span></code> rende lo script leggibile e modulare, semplificando operazioni RFID come autenticazione e lettura dei dati.</p></li>
</ul>
</section>
<section id="immagine-del-fenomeno">
<h2>Immagine del fenomeno<a class="headerlink" href="pi5_2.2.7_mfrc522_rfid_module_python.html#immagine-del-fenomeno" title="Link to this heading">ÔÉÅ</a></h2>
<img alt="../_images/image233.jpeg" src="../_images/image233.jpeg" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pi√® di pagina">
        <a href="pi5_2.2.6_mpu6050_module_python.html" class="btn btn-neutral float-left" title="2.2.6 Modulo MPU6050" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Precedente</a>
        <a href="pi5_extension_python.html" class="btn btn-neutral float-right" title="Estensioni" accesskey="n" rel="next">Prossimo <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, SunFounder.</p>
  </div>

  Realizzato con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    fornito da <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>