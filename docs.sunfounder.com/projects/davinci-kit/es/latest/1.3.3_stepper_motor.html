

<!DOCTYPE html>
<html class="writer-html5" lang="es" data-content_root="./">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.3.3 Stepper Motor &mdash; documentación de SunFounder davinci-kit-for-raspberry-pi - </title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css%3Fv=80d5e7a1.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css%3Fv=e59714d7.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css%3Fv=76b2166b.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/custom.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/index.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/xterm.css" />

  
      <script src="_static/jquery.js%3Fv=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js%3Fv=2cd50e6c"></script>
      <script src="_static/documentation_options.js%3Fv=e2bb6099"></script>
      <script src="_static/doctools.js%3Fv=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js%3Fv=dc90522c"></script>
      <script src="_static/clipboard.min.js%3Fv=a7894cd8"></script>
      <script src="_static/copybutton.js%3Fv=f281be69"></script>
      <script src="_static/translations.js%3Fv=efdbd0b9"></script>
      <script src="https://ezblock.cc/readDocFile/custom.js"></script>
      <script src="https://docs.sunfounder.com/projects/davinci-kit/es/latest/_static/lang.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ace.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ext-language_tools.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/theme-chrome.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-python.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-sh.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/monokai.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/xterm.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/FitAddon.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/readTheDocIndex.js"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/versions.js"></script>
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="1.3.4 Relé" href="1.3.4_relay.html" />
    <link rel="prev" title="1.3.2 Servo" href="1.3.2_servo.html" /> 
<script async type="text/javascript" src="../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="davinci-kit-es" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/1.3.3_stepper_motor.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">
<nav id="nav-bar">
  <ul class="nav-bar-items" id="nav-bar-items">
    <li class="nav-bar-logo">
      <a href="https://sunfounder.com">
        <img class="logo-img" src="https://ezblock.cc/readDocFile/sunfounder_LOGO_160x@2x.png"/>
      </a>
    </li>
  </ul>
</nav>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SunFounder davinci-kit-for-raspberry-pi
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">About this Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="component_list.html">Lista de Componentes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio_extension_board.html">Tarjeta de Extensión GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_the_code.html">Descarga el Código</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_setup_os/install_setup_os.html">Instalar y Configurar Raspberry Pi OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_pi5.html">Para Pi 5</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="for_other_models.html">Para Pi 4, 3 y Todos los Demás Modelos de Pi</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="libraries.html">Bibliotecas</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="1_output.html">1 Salida</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="1.1.1_blinking_led.html">1.1.1 LED Parpadeante</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.1.2_rgb_led.html">1.1.2 RGB LED</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.1.3_led_bar_graph.html">1.1.3 Barra de LEDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.1.4_7-segment_display.html">1.1.4 Pantalla de 7 segmentos</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.1.5_4-Digit_7-segment_display.html">1.1.5 4-Digit 7-Segment Display</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.1.6_led_dot_matrix.html">1.1.6 LED Dot Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.1.7_i2c_lcd1602.html">1.1.7 I2C LCD1602</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.2.1_active_buzzer.html">1.2.1 Zumbador Activo</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.2.2_passive_buzzer.html">1.2.2 Zumbador Pasivo</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.3.1_motor.html">1.3.1 Motor</a></li>
<li class="toctree-l3"><a class="reference internal" href="1.3.2_servo.html">1.3.2 Servo</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="1.3.3_stepper_motor.html#">1.3.3 Stepper Motor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="1.3.3_stepper_motor.html#introduccion">Introducción</a></li>
<li class="toctree-l4"><a class="reference internal" href="1.3.3_stepper_motor.html#componentes">Componentes</a></li>
<li class="toctree-l4"><a class="reference internal" href="1.3.3_stepper_motor.html#principio">Principio</a></li>
<li class="toctree-l4"><a class="reference internal" href="1.3.3_stepper_motor.html#diagrama-esquematico">Diagrama Esquemático</a></li>
<li class="toctree-l4"><a class="reference internal" href="1.3.3_stepper_motor.html#procedimientos-experimentales">Procedimientos Experimentales</a></li>
<li class="toctree-l4"><a class="reference internal" href="1.3.3_stepper_motor.html#imagen-del-fenomeno">Imagen del Fenómeno</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="1.3.4_relay.html">1.3.4 Relé</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2_input.html">2 Entrada</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_extension.html">3 Extensiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="processing/play_with_processing.html">Juega con Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodejs/play_with_nodejs.html">Juega con Nodejs</a></li>
<li class="toctree-l2"><a class="reference internal" href="scratch/play_with_scratch.html">Experimenta con Scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_video/python_video.html">Curso de Video en Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="thank-learning.html">Gracias</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder davinci-kit-for-raspberry-pi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="for_other_models.html">Para Pi 4, 3 y Todos los Demás Modelos de Pi</a></li>
          <li class="breadcrumb-item"><a href="1_output.html">1 Salida</a></li>
      <li class="breadcrumb-item active">1.3.3 Stepper Motor</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/1.3.3_stepper_motor.rst.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Nota</p>
<p>¡Hola! Bienvenido a la comunidad de entusiastas de SunFounder para Raspberry Pi, Arduino y ESP32 en Facebook. Únete para profundizar en Raspberry Pi, Arduino y ESP32 junto a otros apasionados.</p>
<p><strong>¿Por qué unirse?</strong></p>
<ul class="simple">
<li><p><strong>Soporte de expertos</strong>: Soluciona problemas postventa y desafíos técnicos con la ayuda de nuestra comunidad y equipo.</p></li>
<li><p><strong>Aprender y compartir</strong>: Intercambia consejos y tutoriales para mejorar tus habilidades.</p></li>
<li><p><strong>Acceso exclusivo</strong>: Obtén primicias sobre nuevos productos y adelantos.</p></li>
<li><p><strong>Descuentos especiales</strong>: Disfruta de descuentos exclusivos en nuestros productos más recientes.</p></li>
<li><p><strong>Promociones festivas y sorteos</strong>: Participa en sorteos y promociones de temporada.</p></li>
</ul>
<p>👉 ¿Listo para explorar y crear con nosotros? Haz clic en [<a href="https://bit.ly/raphaelkit " target="_blank">Aquí</a>] y únete hoy mismo.</p>
</div>
<section id="stepper-motor">
<h1>1.3.3 Stepper Motor<a class="headerlink" href="1.3.3_stepper_motor.html#stepper-motor" title="Link to this heading"></a></h1>
<section id="introduccion">
<h2>Introducción<a class="headerlink" href="1.3.3_stepper_motor.html#introduccion" title="Link to this heading"></a></h2>
<p>Los motores paso a paso, debido a su diseño único, pueden ser controlados
con gran precisión sin necesidad de mecanismos de retroalimentación. El eje
de un motor paso a paso, equipado con una serie de imanes, es controlado
mediante una secuencia específica de carga positiva y negativa en una serie
de bobinas electromagnéticas, moviéndolo hacia adelante o hacia atrás en pequeños “pasos”.</p>
</section>
<section id="componentes">
<h2>Componentes<a class="headerlink" href="1.3.3_stepper_motor.html#componentes" title="Link to this heading"></a></h2>
<img alt="_images/list_1.3.3.png" src="_images/list_1.3.3.png" />
</section>
<section id="principio">
<h2>Principio<a class="headerlink" href="1.3.3_stepper_motor.html#principio" title="Link to this heading"></a></h2>
<p><strong>Motor Paso a Paso</strong></p>
<p>Existen dos tipos de motores paso a paso: unipolares y bipolares, y es muy
importante saber con cuál tipo se está trabajando. En este experimento,
usaremos un motor paso a paso unipolar.</p>
<p>El motor paso a paso de este proyecto es de cuatro fases y utiliza una fuente
de alimentación de corriente continua unipolar. Al aplicar una secuencia de
activación adecuada en cada fase del motor, este puede rotar paso a paso. El
diagrama esquemático de un motor paso a paso reactivo de cuatro fases:</p>
<img alt="_images/image129.png" src="_images/image129.png" />
<p>En la imagen, en el centro del motor se encuentra el rotor, un imán permanente
en forma de engranaje. Alrededor del rotor, hay dientes numerados de 0 a 5. Más
hacia el exterior, encontramos 8 polos magnéticos, con cada par de polos opuestos
conectados por un devanado de bobina, formando así cuatro pares de la A a la D,
que conforman una fase. Este motor tiene cuatro cables de conexión para ser
enlazados con los interruptores SA, SB, SC y SD, por lo que las cuatro fases
están en paralelo en el circuito y los dos polos magnéticos de una fase están en serie.</p>
<p><strong>Funcionamiento de un motor paso a paso de 4 fases:</strong></p>
<p>Cuando el interruptor SB está activado y los interruptores SA, SC y SD están
desactivados, los polos magnéticos de la fase B se alinean con los dientes 0
y 3 del rotor. Al mismo tiempo, los dientes 1 y 4 están desfasados con los polos
de las fases C y D, y los dientes 2 y 5 están desfasados con los polos de las
fases D y A. Cuando el interruptor SC se activa y los interruptores SB, SA y SD
se desactivan, el rotor gira bajo el campo magnético del devanado de la fase C y
se alinea con los dientes 1 y 4. Al mismo tiempo, los dientes 0 y 3 están
desfasados con los polos de las fases A y B, y los dientes 2 y 5 con los polos
de las fases A y D. Este proceso continúa de la misma manera. Al activar las
fases A, B, C y D en secuencia, el rotor girará en el orden A, B, C y D.</p>
<img alt="_images/image130.png" src="_images/image130.png" />
<p>El motor paso a paso de cuatro fases tiene tres modos de operación: cuatro
pasos simples, cuatro pasos dobles y ocho pasos. El ángulo de paso en el modo
de cuatro pasos simples y cuatro pasos dobles es el mismo, pero el par de torsión
es menor en el modo de cuatro pasos simples. El ángulo de paso en el modo de ocho
pasos es la mitad que en los modos de cuatro pasos, lo que permite un mayor par
de torsión y mejora la precisión de control.</p>
<p>El estator del motor paso a paso que usamos tiene 32 polos magnéticos, por lo que
un giro completo requiere 32 pasos. El eje de salida del motor paso a paso está
conectado a un conjunto de engranajes reductores, con una relación de reducción
de 1/64. Así, el eje de salida final requiere 32*64=2048 pasos para completar una
vuelta completa.</p>
<p><strong>ULN2003</strong></p>
<p>Para aplicar el motor en el circuito, es necesario utilizar una placa de control.
El controlador de motor paso a paso ULN2003 es un circuito inversor de 7 canales.
Es decir, cuando el pin de entrada está en nivel alto, el pin de salida de ULN2003
está en nivel bajo, y viceversa. Si aplicamos nivel alto en IN1 y bajo en IN2,
IN3 e IN4, entonces el extremo de salida OUT1 estará en nivel bajo, y todos los demás
extremos de salida estarán en nivel alto. La estructura interna del chip se muestra a continuación.</p>
<img alt="_images/image338.png" src="_images/image338.png" />
<p>El controlador del motor paso a paso constituido por el chip ULN2003 y 4 LEDs se
muestra a continuación. En la placa, IN1, IN2, IN3 e IN4 funcionan como entradas
y los cuatro LEDs, A, B, C y D, son los indicadores del pin de entrada. Además,
OUT1, OUT2, OUT3 y OUT4 están conectados a SA, SB, SC y SD en el controlador del
motor paso a paso. Cuando el valor de IN1 se establece en nivel alto, A se
enciende; el interruptor SA se activa y el motor paso a paso rota un paso.
Este ciclo se repite en la secuencia adecuada para que el motor gire paso a paso.
El ULN2003 se utiliza aquí para proporcionar las secuencias de tiempo específicas
para el motor paso a paso.</p>
<img alt="_images/image132.png" src="_images/image132.png" />
</section>
<section id="diagrama-esquematico">
<h2>Diagrama Esquemático<a class="headerlink" href="1.3.3_stepper_motor.html#diagrama-esquematico" title="Link to this heading"></a></h2>
<img alt="_images/image339.png" src="_images/image339.png" />
</section>
<section id="procedimientos-experimentales">
<h2>Procedimientos Experimentales<a class="headerlink" href="1.3.3_stepper_motor.html#procedimientos-experimentales" title="Link to this heading"></a></h2>
<p><strong>Paso 1:</strong> Construye el circuito.</p>
<a class="reference internal image-reference" href="_images/image134.png"><img alt="_images/image134.png" src="_images/image134.png" style="width: 800px;" />
</a>
<section id="para-usuarios-de-lenguaje-c">
<h3>Para Usuarios de Lenguaje C<a class="headerlink" href="1.3.3_stepper_motor.html#para-usuarios-de-lenguaje-c" title="Link to this heading"></a></h3>
<p><strong>Paso 2</strong>: Dirígete a la carpeta del código.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="mf">1.3.3</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Paso 3</strong>: Compila el código.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="mf">1.3.3</span><span class="n">_StepperMotor</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">lwiringPi</span>
</pre></div>
</div>
<p><strong>Paso 4</strong>: Ejecuta el archivo compilado.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Al ejecutar el código, el motor paso a paso girará en el sentido de las agujas
del reloj o en sentido contrario, según la entrada que proporciones, 'a' o 'c'.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si no funciona después de ejecutarlo, o aparece un mensaje de error: &quot;wiringPi.h: No such file or directory&quot;, consulta <a class="reference internal" href="faq.html#c-code-is-not-working"><span class="std std-ref">c code is not working?</span></a>.</p>
</div>
<p><strong>Código</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;wiringPi.h&gt;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">motorPin</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">};</span>
<span class="kt">int</span><span class="w"> </span><span class="n">rolePerMinute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">stepsPerRevolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2048</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">stepSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">rotary</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">direction</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">                </span><span class="p">{</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&gt;&gt;</span><span class="n">j</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="mh">0x08</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">));}</span>
<span class="w">            </span><span class="n">delayMicroseconds</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="sc">&#39;a&#39;</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">                </span><span class="p">{</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="mh">0x80</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">));}</span>
<span class="w">            </span><span class="n">delayMicroseconds</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;select motor direction a=anticlockwise, c=clockwise: &quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">        </span><span class="n">direction</span><span class="o">=</span><span class="n">getchar</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;motor running clockwise</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;motor running anti-clockwise</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;input error, please try again!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">rotary</span><span class="p">(</span><span class="n">direction</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wiringPiSetup</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;setup wiringPi failed !&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">pinMode</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">stepSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">60000000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">rolePerMinute</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">stepsPerRevolution</span><span class="p">;</span>
<span class="w">    </span><span class="n">loop</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Explicación del Código</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">rolePerMinute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">stepsPerRevolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2048</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">stepSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>rolePerMinute:</strong> revoluciones por minuto, el RPM del motor paso a paso
usado en este kit debería estar entre 0 y 17.</p>
<p><strong>stepsPerRevolution:</strong> número de pasos por vuelta; el motor paso a paso
de este kit necesita 2048 pasos por revolución.</p>
<p><strong>stepSpeed:</strong> tiempo empleado en cada paso, y en main(), asignamos el
valor a esta variable:「(60000000 / rolePerMinute) / stepsPerRevolution」(60,000,000 us = 1 minuto).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;select motor direction a=anticlockwise, c=clockwise: &quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">direction</span><span class="o">=</span><span class="n">getchar</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;motor running clockwise</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;motor running anti-clockwise</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;input error, please try again!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">rotary</span><span class="p">(</span><span class="n">direction</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>La función loop() se divide en dos partes (ubicadas entre dos while(1)):</p>
<p>La primera parte obtiene el valor de la tecla. Cuando se obtiene 'a' o 'c', se sale del bucle y se detiene la entrada.</p>
<p>La segunda parte llama a rotary(direction) para hacer funcionar el motor paso a paso.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">rotary</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">direction</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">                </span><span class="p">{</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&gt;&gt;</span><span class="n">j</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="mh">0x08</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">));}</span>
<span class="w">            </span><span class="n">delayMicroseconds</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="sc">&#39;a&#39;</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">                </span><span class="p">{</span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="mh">0x80</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">));}</span>
<span class="w">            </span><span class="n">delayMicroseconds</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Para hacer que el motor paso a paso <strong>gire en sentido horario</strong>, el estado de
nivel de motorPin es como se muestra en la tabla a continuación:</p>
<img alt="_images/image340.png" src="_images/image340.png" />
<p>Por lo tanto, la escritura de potencial de MotorPin se implementa usando un
bucle for de dos capas.</p>
<p>En el Paso 1, j=0, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (10011001&amp;00001000=1)</p>
<p>motorPin[1] se establecerá en bajo nivel (10011001&amp;00000100=0)</p>
<p>motorPin[2] se establecerá en bajo nivel (10011001&amp;00000010=0)</p>
<p>motorPin[3] se establecerá en alto nivel (10011001&amp;00000001=1)</p>
<p>En el Paso 2, j=1, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (01001100&amp;00001000=1)</p>
<p>motorPin[1] se establecerá en bajo nivel (01001100&amp;00000100=1)</p>
<p>y así sucesivamente.</p>
<p>Para hacer que el motor paso a paso gire <strong>en sentido antihorario</strong>,
el estado de nivel de motorPin es como se muestra en la siguiente tabla.</p>
<img alt="_images/image341.png" src="_images/image341.png" />
<p>En el Paso 1, j=0, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (10011001 &amp; 10000000 = 1)</p>
<p>motorPin[1] se establecerá en bajo nivel (10011001 &amp; 01000000 = 0)</p>
<p>En el Paso 2, j=1, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (00110010 &amp; 10000000 = 0)</p>
<p>motorPin[1] se establecerá en bajo nivel (00110010 &amp; 01000000 = 0)</p>
<p>y así sucesivamente.</p>
</section>
<section id="para-usuarios-de-lenguaje-python">
<h3>Para Usuarios de Lenguaje Python<a class="headerlink" href="1.3.3_stepper_motor.html#para-usuarios-de-lenguaje-python" title="Link to this heading"></a></h3>
<p><strong>Paso 2</strong>: Dirígete a la carpeta del código.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Paso 3</strong>: Ejecuta el archivo.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">1.3.3</span><span class="n">_StepperMotor</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Al ejecutar el código, el motor paso a paso girará en el sentido de las
agujas del reloj o en sentido contrario, según la entrada que proporciones, 'a' o 'c'.</p>
<p><strong>Código</strong></p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Puedes <strong>Modificar/Restablecer/Copiar/Ejecutar/Detener</strong> el código a
continuación. Antes de eso, necesitas dirigirte a la ruta del código
fuente como <code class="docutils literal notranslate"><span class="pre">davinci-kit-for-raspberry-pi/python</span></code>.</p>
</div>
<run></run><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">RPi.GPIO</span> <span class="k">as</span> <span class="nn">GPIO</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="n">motorPin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">rolePerMinute</span> <span class="o">=</span><span class="mi">15</span>
<span class="n">stepsPerRevolution</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">stepSpeed</span> <span class="o">=</span> <span class="p">(</span><span class="mi">60</span><span class="o">/</span><span class="n">rolePerMinute</span><span class="p">)</span><span class="o">/</span><span class="n">stepsPerRevolution</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setwarnings</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BCM</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">motorPin</span><span class="p">:</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">rotary</span><span class="p">(</span><span class="n">direction</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&gt;&gt;</span><span class="n">j</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x08</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">))</span>
            <span class="n">sleep</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">)</span>

    <span class="k">elif</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&lt;&lt;</span><span class="n">j</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x80</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">))</span>
            <span class="n">sleep</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;select motor direction a=anticlockwise, c=clockwise: &#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;motor running clockwise</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;motor running anti-clockwise</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input error, please try again!&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">rotary</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">setup</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">loop</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Explicación del Código</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rolePerMinute</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">stepsPerRevolution</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="n">stepSpeed</span> <span class="o">=</span> <span class="p">(</span><span class="mi">60</span> <span class="o">/</span> <span class="n">rolePerMinute</span><span class="p">)</span> <span class="o">/</span> <span class="n">stepsPerRevolution</span>
</pre></div>
</div>
<p><strong>rolePerMinute:</strong> revoluciones por minuto, el RPM del motor paso a paso
utilizado en este kit debería estar entre 0 y 17.</p>
<p><strong>stepsPerRevolution:</strong> número de pasos por vuelta; el motor paso a paso
de este kit necesita 2048 pasos para una revolución completa.</p>
<p><strong>stepSpeed:</strong> tiempo empleado en cada paso; asignamos el valor de esta
variable mediante la fórmula:「(60 / rolePerMinute) / stepsPerRevolution」(60s=1 minuto).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;select motor direction a=anticlockwise, c=clockwise: &#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;motor running clockwise</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;motor running anti-clockwise</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input error, please try again!&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">rotary</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
</pre></div>
</div>
<p>La función loop() se divide aproximadamente en dos partes (ubicadas entre dos
while(1)):</p>
<p>La primera parte obtiene el valor de la tecla. Cuando se obtiene 'a' o 'c',
se sale del bucle y se detiene la entrada.</p>
<p>La segunda parte llama a rotary(direction) para que el motor paso a paso funcione.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rotary</span><span class="p">(</span><span class="n">direction</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&gt;&gt;</span><span class="n">j</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x08</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">))</span>
            <span class="n">sleep</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">)</span>

    <span class="k">elif</span><span class="p">(</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">motorPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mh">0x99</span><span class="o">&lt;&lt;</span><span class="n">j</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mh">0x80</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">))</span>
            <span class="n">sleep</span><span class="p">(</span><span class="n">stepSpeed</span><span class="p">)</span>
</pre></div>
</div>
<p>Para hacer que el motor paso a paso gire en sentido horario, el estado de nivel de motorPin
se muestra en la siguiente tabla:</p>
<img alt="_images/image342.png" src="_images/image342.png" />
<p>Por lo tanto, la escritura de potencial de MotorPin se implementa utilizando un
bucle for de dos capas.</p>
<p>En el Paso 1, j=0, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (10011001 &amp; 00001000 = 1)</p>
<p>motorPin[1] se establecerá en bajo nivel (10011001 &amp; 00000100 = 0)</p>
<p>motorPin[2] se establecerá en bajo nivel (10011001 &amp; 00000010 = 0)</p>
<p>motorPin[3] se establecerá en alto nivel (10011001 &amp; 00000001 = 1)</p>
<p>En el Paso 2, j=1, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (01001100 &amp; 00001000 = 1)</p>
<p>motorPin[1] se establecerá en bajo nivel (01001100 &amp; 00000100 = 1)</p>
<p>y así sucesivamente.</p>
<p>Para hacer que el motor paso a paso gire en sentido antihorario, el estado de nivel de motorPin
se muestra en la siguiente tabla:</p>
<img alt="_images/image343.png" src="_images/image343.png" />
<p>En el Paso 1, j=0, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (10011001 &amp; 10000000 = 1)</p>
<p>motorPin[1] se establecerá en bajo nivel (10011001 &amp; 01000000 = 0)</p>
<p>En el Paso 2, j=1, i=0~4.</p>
<p>motorPin[0] se establecerá en alto nivel (00110010 &amp; 10000000 = 0)</p>
<p>motorPin[1] se establecerá en bajo nivel (00110010 &amp; 01000000 = 0)</p>
<p>y así sucesivamente.</p>
</section>
</section>
<section id="imagen-del-fenomeno">
<h2>Imagen del Fenómeno<a class="headerlink" href="1.3.3_stepper_motor.html#imagen-del-fenomeno" title="Link to this heading"></a></h2>
<img alt="_images/image135.jpeg" src="_images/image135.jpeg" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="1.3.2_servo.html" class="btn btn-neutral float-left" title="1.3.2 Servo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="1.3.4_relay.html" class="btn btn-neutral float-right" title="1.3.4 Relé" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2025, SunFounder.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>