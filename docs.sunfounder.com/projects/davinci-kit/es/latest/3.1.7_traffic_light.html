

<!DOCTYPE html>
<html class="writer-html5" lang="es" data-content_root="./">
<head>
  <meta charset="utf-8" />
  <meta name="readthedocs-addons-api-version" content="1"><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.7 Semáforo &mdash; documentación de SunFounder davinci-kit-for-raspberry-pi - </title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css%3Fv=80d5e7a1.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css%3Fv=e59714d7.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css%3Fv=76b2166b.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/custom.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/index.css" />
      <link rel="stylesheet" type="text/css" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/xterm.css" />

  
      <script src="_static/jquery.js%3Fv=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js%3Fv=2cd50e6c"></script>
      <script src="_static/documentation_options.js%3Fv=e2bb6099"></script>
      <script src="_static/doctools.js%3Fv=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js%3Fv=dc90522c"></script>
      <script src="_static/clipboard.min.js%3Fv=a7894cd8"></script>
      <script src="_static/copybutton.js%3Fv=f281be69"></script>
      <script src="_static/translations.js%3Fv=efdbd0b9"></script>
      <script src="https://ezblock.cc/readDocFile/custom.js"></script>
      <script src="https://docs.sunfounder.com/projects/davinci-kit/es/latest/_static/lang.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ace.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ext-language_tools.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/theme-chrome.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-python.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-sh.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/monokai.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/xterm.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/FitAddon.js"></script>
      <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/readTheDocIndex.js"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/versions.js"></script>
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="3.1.8 Monitor de Sobrecalentamiento" href="3.1.8_overheat_monitor.html" />
    <link rel="prev" title="3.1.6 Control de Movimiento" href="3.1.6_motion_control.html" /> 
<script async type="text/javascript" src="../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="davinci-kit-es" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/3.1.7_traffic_light.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">
<nav id="nav-bar">
  <ul class="nav-bar-items" id="nav-bar-items">
    <li class="nav-bar-logo">
      <a href="https://sunfounder.com">
        <img class="logo-img" src="https://ezblock.cc/readDocFile/sunfounder_LOGO_160x@2x.png"/>
      </a>
    </li>
  </ul>
</nav>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SunFounder davinci-kit-for-raspberry-pi
          </a>
              <div class="switch-menus">
                <div class="version-switch"></div>
                <div class="language-switch"></div>
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">About this Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="component_list.html">Lista de Componentes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio_extension_board.html">Tarjeta de Extensión GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_the_code.html">Descarga el Código</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_setup_os/install_setup_os.html">Instalar y Configurar Raspberry Pi OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_pi5.html">Para Pi 5</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="for_other_models.html">Para Pi 4, 3 y Todos los Demás Modelos de Pi</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="libraries.html">Bibliotecas</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_output.html">1 Salida</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_input.html">2 Entrada</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="3_extension.html">3 Extensiones</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="3.1.1_counting_device.html">3.1.1 Dispositivo de Conteo</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.2_welcome.html">3.1.2 Bienvenida</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.3_reversing_alarm.html">3.1.3 Alarma de Reversa</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.4_smart_fan.html">3.1.4 Ventilador Inteligente</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.5_battery_indicator.html">3.1.5 Indicador de Batería</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.6_motion_control.html">3.1.6 Control de Movimiento</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="3.1.7_traffic_light.html#">3.1.7 Semáforo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="3.1.7_traffic_light.html#introduccion">Introducción</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.7_traffic_light.html#componentes">Componentes</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.7_traffic_light.html#diagrama-de-esquema">Diagrama de Esquema</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.7_traffic_light.html#procedimiento-experimental">Procedimiento Experimental</a></li>
<li class="toctree-l4"><a class="reference internal" href="3.1.7_traffic_light.html#imagen-del-resultado">Imagen del Resultado</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="3.1.8_overheat_monitor.html">3.1.8 Monitor de Sobrecalentamiento</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.9_password_lock.html">3.1.9 Bloqueo por Contraseña</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.10_alarm_bell.html">3.1.10 Alarma</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.11_morse_code_generator.html">3.1.11 Generador de Código Morse</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.12_game_guess_number.html">3.1.12 JUEGO– Adivina el Número</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.13_game_10_second.html">3.1.13 JUEGO– 10 Segundos</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.1.14_game_not_not.html">3.1.14 JUEGO – Not Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="processing/play_with_processing.html">Juega con Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="nodejs/play_with_nodejs.html">Juega con Nodejs</a></li>
<li class="toctree-l2"><a class="reference internal" href="scratch/play_with_scratch.html">Experimenta con Scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_video/python_video.html">Curso de Video en Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="thank-learning.html">Gracias</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder davinci-kit-for-raspberry-pi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="for_other_models.html">Para Pi 4, 3 y Todos los Demás Modelos de Pi</a></li>
          <li class="breadcrumb-item"><a href="3_extension.html">3 Extensiones</a></li>
      <li class="breadcrumb-item active">3.1.7 Semáforo</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/3.1.7_traffic_light.rst.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Nota</p>
<p>¡Hola, bienvenido a la comunidad de entusiastas de SunFounder Raspberry Pi, Arduino y ESP32 en Facebook! Profundiza en el uso de Raspberry Pi, Arduino y ESP32 junto a otros entusiastas.</p>
<p><strong>¿Por qué unirte?</strong></p>
<ul class="simple">
<li><p><strong>Soporte de Expertos</strong>: Resuelve problemas post-venta y desafíos técnicos con la ayuda de nuestra comunidad y equipo.</p></li>
<li><p><strong>Aprende y Comparte</strong>: Intercambia consejos y tutoriales para mejorar tus habilidades.</p></li>
<li><p><strong>Avances Exclusivos</strong>: Obtén acceso anticipado a anuncios de nuevos productos y adelantos.</p></li>
<li><p><strong>Descuentos Especiales</strong>: Disfruta de descuentos exclusivos en nuestros productos más recientes.</p></li>
<li><p><strong>Promociones Festivas y Sorteos</strong>: Participa en sorteos y promociones especiales durante las festividades.</p></li>
</ul>
<p>👉 ¿Listo para explorar y crear con nosotros? Haz clic en [<a href="https://bit.ly/raphaelkit " target="_blank">Aquí</a>] y únete hoy mismo.</p>
</div>
<section id="semaforo">
<h1>3.1.7 Semáforo<a class="headerlink" href="3.1.7_traffic_light.html#semaforo" title="Link to this heading"></a></h1>
<section id="introduccion">
<h2>Introducción<a class="headerlink" href="3.1.7_traffic_light.html#introduccion" title="Link to this heading"></a></h2>
<p>En este proyecto, utilizaremos luces LED de tres colores para simular
el cambio de un semáforo. Además, usaremos una pantalla de 7 segmentos
de cuatro dígitos para mostrar la cuenta regresiva de cada estado del semáforo.</p>
</section>
<section id="componentes">
<h2>Componentes<a class="headerlink" href="3.1.7_traffic_light.html#componentes" title="Link to this heading"></a></h2>
<img alt="_images/list_Traffic_Light.png" class="align-center" src="_images/list_Traffic_Light.png" />
</section>
<section id="diagrama-de-esquema">
<h2>Diagrama de Esquema<a class="headerlink" href="3.1.7_traffic_light.html#diagrama-de-esquema" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>T-Board Name</p></td>
<td><p>physical</p></td>
<td><p>wiringPi</p></td>
<td><p>BCM</p></td>
</tr>
<tr class="row-even"><td><p>GPIO17</p></td>
<td><p>Pin 11</p></td>
<td><p>0</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO27</p></td>
<td><p>Pin 13</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-even"><td><p>GPIO22</p></td>
<td><p>Pin 15</p></td>
<td><p>3</p></td>
<td><p>22</p></td>
</tr>
<tr class="row-odd"><td><p>SPIMOSI</p></td>
<td><p>Pin 19</p></td>
<td><p>12</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>GPIO18</p></td>
<td><p>Pin 12</p></td>
<td><p>1</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO23</p></td>
<td><p>Pin 16</p></td>
<td><p>4</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>GPIO24</p></td>
<td><p>Pin 18</p></td>
<td><p>5</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO25</p></td>
<td><p>Pin 22</p></td>
<td><p>6</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>SPICE0</p></td>
<td><p>Pin 24</p></td>
<td><p>10</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>SPICE1</p></td>
<td><p>Pin 26</p></td>
<td><p>11</p></td>
<td><p>7</p></td>
</tr>
</tbody>
</table>
<img alt="_images/Schematic_three_one7.png" class="align-center" src="_images/Schematic_three_one7.png" />
</section>
<section id="procedimiento-experimental">
<h2>Procedimiento Experimental<a class="headerlink" href="3.1.7_traffic_light.html#procedimiento-experimental" title="Link to this heading"></a></h2>
<p><strong>Paso 1:</strong> Construye el circuito.</p>
<a class="reference internal image-reference" href="_images/image254.png"><img alt="_images/image254.png" src="_images/image254.png" style="width: 800px;" />
</a>
<section id="para-usuarios-de-c">
<h3><strong>Para Usuarios de C</strong><a class="headerlink" href="3.1.7_traffic_light.html#para-usuarios-de-c" title="Link to this heading"></a></h3>
<p><strong>Paso 2:</strong> Cambia al directorio.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="mf">3.1.7</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Paso 3:</strong> Compila.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="mf">3.1.7</span><span class="n">_TrafficLight</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">lwiringPi</span>
</pre></div>
</div>
<p><strong>Paso 4:</strong> Ejecuta.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Al ejecutar el código, los LEDs simularán el cambio de colores de un semáforo.
Primero, se enciende el LED rojo durante 60 segundos, luego el LED verde se
enciende durante 30 segundos, y finalmente el LED amarillo se enciende durante
5 segundos. Después, el ciclo vuelve a iniciar con el LED rojo encendido por 60
segundos. Esta secuencia se repetirá continuamente.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si no funciona después de ejecutar el programa, o aparece un mensaje de error: &quot;wiringPi.h: No such file or directory&quot;, consulta <a class="reference internal" href="faq.html#c-code-is-not-working"><span class="std std-ref">c code is not working?</span></a>.</p>
</div>
<p><strong>Explicación del Código</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define     SDI     5</span>
<span class="cp">#define     RCLK    4</span>
<span class="cp">#define     SRCLK    1</span>

<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">placePin</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">number</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">0xc0</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf9</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa4</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x99</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x82</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span><span class="mh">0x90</span><span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">pickDigit</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">digit</span><span class="p">);</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">hc595_shift</span><span class="p">(</span><span class="kt">int8_t</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">clearDisplay</span><span class="p">();</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">display</span><span class="p">();</span>
</pre></div>
</div>
<p>Estas líneas de código permiten realizar la función de visualización de
números en una pantalla de 7 segmentos de 4 dígitos. Consulta <a class="reference internal" href="python_pi5/pi5_1.1.5_4-Digit_7-segment_display_python.html#pantalla-de-7-segmentos-de-4-digitos"><span class="std std-ref">1.1.5 Pantalla de 7 Segmentos de 4 Dígitos</span></a>
para más detalles. Aquí, el código muestra la cuenta regresiva del tiempo del semáforo.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ledPin</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="n">colorState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">lightup</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">        </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">HIGH</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">colorState</span><span class="p">],</span><span class="n">LOW</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Estas líneas controlan el encendido y apagado de los LEDs.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">greenLight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">yellowLight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">redLight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">colorState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">lightColor</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;Red&quot;</span><span class="p">,</span><span class="s">&quot;Green&quot;</span><span class="p">,</span><span class="s">&quot;Yellow&quot;</span><span class="p">};</span>
<span class="kt">int</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">timer</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">timer1</span><span class="p">){</span><span class="w">       </span><span class="c1">// Función de temporizador</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">timer1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SIGALRM</span><span class="p">){</span>
<span class="w">        </span><span class="n">counter</span><span class="w"> </span><span class="o">--</span><span class="p">;</span>
<span class="w">        </span><span class="n">alarm</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">colorState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">greenLight</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">colorState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yellowLight</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">colorState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">redLight</span><span class="p">;</span>
<span class="w">            </span><span class="n">colorState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">colorState</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;counter : %d </span><span class="se">\t</span><span class="s"> light color: %s </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">counter</span><span class="p">,</span><span class="n">lightColor</span><span class="p">[</span><span class="n">colorState</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Estas líneas controlan el temporizador. Consulta <a class="reference internal" href="1.1.5_4-Digit_7-segment_display.html#digit-7-segment-display"><span class="std std-ref">1.1.5 4-Digit 7-Segment Display</span></a> para más detalles.
Cuando el temporizador llega a cero, se cambia el color de <cite>colorState</cite>, activando el LED correspondiente y
reasignando un nuevo valor al temporizador.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
<span class="w">    </span><span class="n">display</span><span class="p">();</span>
<span class="w">    </span><span class="n">lightup</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//…</span>
<span class="w">    </span><span class="n">signal</span><span class="p">(</span><span class="n">SIGALRM</span><span class="p">,</span><span class="n">timer</span><span class="p">);</span>
<span class="w">    </span><span class="n">alarm</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">loop</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>El temporizador se inicia en la función main(). En la función loop(), se usa un ciclo <strong>while(1)</strong> y se llaman las funciones de visualización de la pantalla de 7 segmentos y el control de los LEDs.
<strong>Para Usuarios de Python</strong>
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<p><strong>Paso 2:</strong> Cambiar de directorio.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Paso 3:</strong> Ejecutar.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">3.1.7</span><span class="n">_TrafficLight</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>A medida que el código se ejecuta, los LEDs simularán el cambio de colores de
un semáforo. Primero, el LED rojo se ilumina durante 60 segundos, luego el LED
verde durante 30 segundos; después, el LED amarillo durante 5 segundos.
Tras esto, el LED rojo se enciende nuevamente por 60 segundos. Así, esta serie
de acciones se ejecutará en un bucle. Mientras tanto, la pantalla de 7 segmentos
de 4 dígitos muestra el tiempo de cuenta regresiva de forma continua.</p>
<p><strong>Código</strong></p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Puedes <strong>Modificar/Restablecer/Copiar/Ejecutar/Detener</strong> el código a continuación. Pero antes, debes dirigirte a la ruta del código fuente como <code class="docutils literal notranslate"><span class="pre">davinci-kit-for-raspberry-pi/python</span></code>.</p>
</div>
<run></run><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">RPi.GPIO</span> <span class="k">as</span> <span class="nn">GPIO</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="c1"># Definir los pines conectados al 74HC595</span>
<span class="n">SDI</span>   <span class="o">=</span> <span class="mi">24</span>      <span class="c1"># entrada de datos en serie (DS)</span>
<span class="n">RCLK</span>  <span class="o">=</span> <span class="mi">23</span>     <span class="c1"># entrada de reloj de memoria (STCP)</span>
<span class="n">SRCLK</span> <span class="o">=</span> <span class="mi">18</span>      <span class="c1"># entrada de reloj del registro de desplazamiento (SHCP)</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0xf8</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x90</span><span class="p">)</span>

<span class="n">placePin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ledPin</span> <span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>

<span class="n">greenLight</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">yellowLight</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">redLight</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">lightColor</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span><span class="s2">&quot;Green&quot;</span><span class="p">,</span><span class="s2">&quot;Yellow&quot;</span><span class="p">)</span>

<span class="n">colorState</span><span class="o">=</span><span class="mi">0</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">timer1</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BCM</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">SDI</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">RCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">SRCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">pin</span> <span class="ow">in</span> <span class="n">placePin</span><span class="p">:</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span><span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">pin</span> <span class="ow">in</span> <span class="n">ledPin</span><span class="p">:</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span><span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">clearDisplay</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">SDI</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">SRCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">SRCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">RCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">RCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">hc595_shift</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">SDI</span><span class="p">,</span> <span class="mh">0x80</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">SRCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">SRCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">RCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">RCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pickDigit</span><span class="p">(</span><span class="n">digit</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">placePin</span><span class="p">:</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">placePin</span><span class="p">[</span><span class="n">digit</span><span class="p">],</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">timer</span><span class="p">():</span>        <span class="c1"># función de temporizador</span>
    <span class="k">global</span> <span class="n">counter</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">counter</span><span class="o">-=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span> <span class="n">greenLight</span>
        <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">yellowLight</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">redLight</span>
        <span class="n">colorState</span><span class="o">=</span><span class="p">(</span><span class="n">colorState</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;counter : </span><span class="si">%d</span><span class="s2">    color: </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span><span class="n">lightColor</span><span class="p">[</span><span class="n">colorState</span><span class="p">]))</span>

<span class="k">def</span> <span class="nf">lightup</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">colorState</span><span class="p">],</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">display</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">counter</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">10000</span><span class="o">//</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">1000</span><span class="o">//</span><span class="mi">100</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">10000</span><span class="o">//</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">1000</span><span class="o">//</span><span class="mi">100</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">100</span><span class="o">//</span><span class="mi">10</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">10000</span><span class="o">//</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">1000</span><span class="o">//</span><span class="mi">100</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">100</span><span class="o">//</span><span class="mi">10</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">%</span> <span class="mi">10</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">%</span> <span class="mi">10000</span><span class="o">//</span><span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
        <span class="n">pickDigit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">counter</span> <span class="o">%</span> <span class="mi">10000</span><span class="o">//</span><span class="mi">1000</span><span class="p">])</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
        <span class="n">pickDigit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">counter</span> <span class="o">%</span> <span class="mi">1000</span><span class="o">//</span><span class="mi">100</span><span class="p">])</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
        <span class="n">pickDigit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">counter</span> <span class="o">%</span> <span class="mi">100</span><span class="o">//</span><span class="mi">10</span><span class="p">])</span>

    <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">clearDisplay</span><span class="p">()</span>
        <span class="n">pickDigit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">counter</span> <span class="o">%</span> <span class="mi">10</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">display</span><span class="p">()</span>
        <span class="n">lightup</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>   <span class="c1"># Cuando se presiona &quot;Ctrl+C&quot;, la función se ejecuta.</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>      <span class="c1"># cancelar el temporizador</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span> <span class="c1"># El programa comienza aquí</span>
    <span class="n">setup</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">loop</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Explicación del Código</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SDI</span>   <span class="o">=</span> <span class="mi">24</span>      <span class="c1"># entrada de datos en serie (DS)</span>
<span class="n">RCLK</span>  <span class="o">=</span> <span class="mi">23</span>     <span class="c1"># entrada de reloj de memoria (STCP)</span>
<span class="n">SRCLK</span> <span class="o">=</span> <span class="mi">18</span>      <span class="c1"># entrada de reloj del registro de desplazamiento (SHCP)</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0xf8</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x90</span><span class="p">)</span>
<span class="n">placePin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">clearDisplay</span><span class="p">():</span>
<span class="k">def</span> <span class="nf">hc595_shift</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">pickDigit</span><span class="p">(</span><span class="n">digit</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">display</span><span class="p">():</span>
</pre></div>
</div>
<p>Estos códigos se utilizan para implementar la función de visualización numérica
de una pantalla de 7 segmentos de 4 dígitos. Consulte <a class="reference internal" href="1.1.5_4-Digit_7-segment_display.html#digit-7-segment-display"><span class="std std-ref">1.1.5 4-Digit 7-Segment Display</span></a>
en el documento para obtener más detalles. Aquí, usamos el código para mostrar la cuenta regresiva del semáforo.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ledPin</span> <span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">colorState</span><span class="o">=</span><span class="mi">0</span>

<span class="k">def</span> <span class="nf">lightup</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">colorState</span><span class="p">],</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
</pre></div>
</div>
<p>Estos códigos se usan para encender y apagar el LED.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">greenLight</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">yellowLight</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">redLight</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">lightColor</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span><span class="s2">&quot;Green&quot;</span><span class="p">,</span><span class="s2">&quot;Yellow&quot;</span><span class="p">)</span>

<span class="n">colorState</span><span class="o">=</span><span class="mi">0</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">timer1</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">timer</span><span class="p">():</span>        <span class="c1"># función de temporizador</span>
    <span class="k">global</span> <span class="n">counter</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">counter</span><span class="o">-=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span> <span class="n">greenLight</span>
        <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">yellowLight</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">redLight</span>
        <span class="n">colorState</span><span class="o">=</span><span class="p">(</span><span class="n">colorState</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;counter : </span><span class="si">%d</span><span class="s2">    color: </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span><span class="n">lightColor</span><span class="p">[</span><span class="n">colorState</span><span class="p">]))</span>
</pre></div>
</div>
<p>Los códigos se usan para controlar el temporizador. Consulte <a class="reference internal" href="1.1.5_4-Digit_7-segment_display.html#digit-7-segment-display"><span class="std std-ref">1.1.5 4-Digit 7-Segment Display</span></a>
para obtener más detalles. Aquí, cuando el temporizador llega a cero, <cite>colorState</cite> cambiará para
alternar el LED, y el temporizador se asignará a un nuevo valor.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
    <span class="c1"># ...</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">display</span><span class="p">()</span>
        <span class="n">lightup</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>  <span class="c1"># Cuando se presiona &quot;Ctrl+C&quot;, se ejecuta la función.</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>  <span class="c1"># cancelar el temporizador</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>  <span class="c1"># El programa comienza aquí</span>
    <span class="n">setup</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">loop</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p>En la función setup(), se inicia el temporizador. En la función loop(),
se utiliza un bucle <code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">True</span></code> para llamar repetidamente a las funciones
relacionadas con la pantalla de 7 segmentos de 4 dígitos y el LED.</p>
</section>
</section>
<section id="imagen-del-resultado">
<h2>Imagen del Resultado<a class="headerlink" href="3.1.7_traffic_light.html#imagen-del-resultado" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="_images/IMG_8319.jpg"><img alt="_images/IMG_8319.jpg" class="align-center" src="_images/IMG_8319.jpg" style="width: 800px;" />
</a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="3.1.6_motion_control.html" class="btn btn-neutral float-left" title="3.1.6 Control de Movimiento" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="3.1.8_overheat_monitor.html" class="btn btn-neutral float-right" title="3.1.8 Monitor de Sobrecalentamiento" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2025, SunFounder.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>